{"version":3,"sources":["helpers/cache.ts","apis/brsUrlProvider.ts","helpers/CustomError.ts","apis/brsAuth.ts","Context.tsx","components/loginPage/GoogleLoginButton.tsx","components/CustomAlert.tsx","components/submitWithLoading/index.tsx","apis/brsApi.ts","components/loginPage/brsLoginForm/index.tsx","apis/googleAuth.ts","components/loginPage/index.tsx","components/loginPage/LoginPageWrapper.tsx","apis/googleApi.ts","helpers/tools.ts","helpers/brsHelpers.ts","functions/readStudentsAsync.ts","functions/getSpreadsheetDataAsync.ts","components/nestedList/index.tsx","functions/getSuitableDisciplinesAsync.ts","components/workPage/worker/RunWorkerButtons.tsx","helpers/fio.ts","marksActions/MarksManager.ts","helpers/logger.ts","components/workPage/worker/workerDialog/index.tsx","components/spreadsheetFetch/index.tsx","helpers/catchOrReturn.ts","components/SessionExpiredAlert.tsx","components/workPage/loadingPane/LoadingPane.tsx","components/workPage/WorkPage.tsx","components/workPage/WorkPageWrapper.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["StorageType","brsUrl","BrsUrlProvider","withProxy","this","memoryCache","save","name","data","whereTo","json","JSON","stringify","Local","LocalAndSession","localStorage","setItem","Session","sessionStorage","read","whereFrom","localData","content","getItem","memoryData","parse","clear","storageType","removeItem","StatusCode","CustomError","statusCode","message","LoginStatus","BrsAuth","brsUrlProvider","_sid","_login","_username","loginInfo","cache","saveLoginInfo","sid","login","username","checkSidAsync","sidCheckResult","success","request","method","url","baseUrl","headers","response","match","password","requestSidAsync","Error","cookie","result","checkResult","InvalidCredentials","Succeed","body","resolveWithFullResponse","simple","then","x","BrsUnauthorized","Context","createContext","GoogleLoginButton","props","onSignedIn","onFailure","signedIn","onLogout","Fragment","Button","type","fullWidth","variant","onClick","color","clientId","buttonText","onSuccess","scope","isSignedIn","CustomAlert","open","onClose","Snackbar","autoHideDuration","anchorOrigin","vertical","horizontal","severity","Alert","elevation","SubmitWithLoading","title","loading","className","disabled","CircularProgress","size","StudentFailure","TermType","onSubmit","submitting","React","useState","setLogin","setPassword","setSid","e","preventDefault","TextField","margin","id","label","autoFocus","value","onChange","target","autoComplete","DISCOVERY_DOCS","googleAuth","init","gapi","client","Promise","resolve","load","a","discoveryDocs","catch","console","error","checkAuthorized","auth2","getAuthInstance","get","getUsername","currentUser","getBasicProfile","getName","getEmail","logout","signOut","LoginPage","handleBrsSubmit","credentials","setState","submitLoading","loginBrsAsync","loginStatus","alertMessage","openAlert","alertType","brsAuthorized","brsAuth","authBySidAsync","loginAsync","handleCloseAlert","handleGoogleSignedIn","googleAuthorized","handleGoogleLoginFailed","startWork","redirect","handleBrsLogout","handleGoogleLogout","state","brsLoading","tryRestoreAsync","checkAuth","to","Container","component","maxWidth","Grid","container","justify","item","md","lg","sm","xs","Component","Consumer","context","BrsApi","year","termType","course","isModule","cacheName","cacheResult","getDisciplineTotalAsync","total","getDisciplineInternalAsync","queryString","requestApiJsonAsync","paging","disciplines","moduleParameter","discipline","getStudentMarksAsync","students","uniqueStudents","s","knownStudent","studentUuid","Object","keys","map","k","cardType","markType","getStudentMarksInternalAsync","disciplineLoad","groupHistoryId","groupId","groupUuid","techgroup","isTotal","showActiveStudents","groupPart","getControlActionsCachedAsync","getControlActionsInternalAsync","modulePart","requestApiAsync","prefix","suffix","linesWithId","split","trim","filter","startsWith","length","columns","substr","uuidPrefix","c","uuid","uuidWithoutPrefix","controlAction","controlActionId","mark","cardTypeKey","disciplineLoadUuid","isNaN","toString","studentFailure","NoFailure","updateMarksAsync","updateMarksInternalAsync","uri","options","trimLeft","getSpreadsheet","spreadsheetId","sheets","range","spreadsheets","values","readAsync","writeAsync","asEnteredByUser","valueInputOption","requestBody","update","appendAsync","append","getSpreadsheetProperties","res","sheetProps","properties","normalizeString","str","toLowerCase","replace","compareNormalized","s1","s2","parseAnyFloat","parseFloat","failureMapping","NotChosen","NotAllowedByDeansOffice","NotAppeared","Неуважительная","DisrespectfulReason","Уважительная","RespectfulReason","NotAllowedByTeacher","ShouldNotPass","AcademicLeave","Выбыл","DroppedOut","parseStudentFailure","input","undefined","key","formatStudentFailure","fromSpreadsheetAsync","readRange","fullNameIndex","groupNameIndex","idIndex","failureIndex","sheet","googleApi","rows","row","fullName","groupName","failure","push","getSpreadsheetDataAsync","sheetName","readRowsFromSpreadsheetAsync","header","getHeader","indices","buildIndicesBy","dataRange","buildDataRange","controlActionConfigs","buildControlActionConfig","disciplineConfig","buildDisciplineConfig","readStudents","fullNameColumn","left","groupColumn","failureColumn","actualStudents","normalizedHeader","groupColumnIndex","indexOf","fullNameColumnIndex","failureColumnIndex","disciplineParameterKeyColumnIndex","disciplineParameterValueColumnIndex","Math","abs","disciplineKeyColumn","disciplineValueColumn","min","right","leftLetter","String","fromCharCode","charCodeAt","rightLetter","index","controlActions","propertyIndex","config","sameColumns","matchCount","matchIndex","isSuitableDiscipline","Fall","defaultStudentFailure","i","addDisciplineConfigParameter","parseInt","Spring","lowerValue","NestedList","items","collapsed","listSubheader","ListSubheader","hidden","List","aria-labelledby","subheader","ConstructItems","ListItem","ListItemText","primary","Item","setOpen","nestedItems","hasSubItems","button","ListItemIcon","ExpandLess","ExpandMore","nestedItem","NestedItem","colored","Collapse","in","timeout","unmountOnExit","disablePadding","getSuitableDisciplinesAsync","brsApi","getDisciplineCachedAsync","allDisciplines","d","enabled","onRunWorkSafe","onRunWorkUnsafe","toKey","fio","MarksManager","logger","cancelPending","spreadsheetData","suitableDisciplines","putMarksForDisciplineAsync","group","log","getAllControlActionsCachedAsync","checkControlActionsConfiguration","getAllStudentMarksAsync","brsStudents","mergeStudents","mergedStudents","skippedActualStudents","skippedBrsStudents","logMergedStudents","putMarksForStudentsAsync","updateFailuresForSkippedStudentsAsync","updateAllMarksAsync","getSuitableControlAction","statusCounters","student","putMarksForStudentAsync","status","updated","failed","marks","brsMark","brs","actualMark","actual","putStudentMarkAsync","brsFailureStatus","actualFailure","failureStatus","putStudentFailureAsync","verbose","studentName","join","suitableControlActions","some","b","updateFailureForStudent","statusKeys","studentFio","description","activeBrsStudents","isStudentActive","actualStudent","suitableStudents","brsStudent","brsFullName","actualFullName","areStudentsLike","ms","studentStatus","Logger","logHandlers","errorHandlers","logHandler","h","errorHandler","errorMessage","DialogContent","withStyles","root","padding","MuiDialogContent","DialogActions","display","justifyContent","MuiDialogActions","WorkerDialog","marksManager","logMessage","logItems","getLogger","addLogHandler","marksData","putMarksToBrsAsync","removeLogHandler","okLoading","cancelWork","cancel","Dialog","runWork","dividers","dense","style","minHeight","paddingTop","paddingBottom","marginTop","marginBottom","onClosed","SpreadsheetFetch","handleTableUrlChanged","event","tableUrlError","tableUrl","loadDisciplines","getActualSpreadsheetDataAsync","getAvailableDisciplinesAsync","availableDisciplines","disciplinesInfo","disciplinesToListItems","showDisciplines","disciplinesMissed","missed","showWorkerButtons","updateCachedDisciplines","action","onError","catchOrReturn","addErrorHandler","runWorker","handleRunWorkSafe","handleRunWorkUnsafe","handleWorkerClosed","actualGroups","Set","availableGroups","missedCount","Array","from","groupMissed","has","getSpreadsheetInfoAsync","spreadsheetInfo","regExp","groups","maybeSheetId","sheetId","spreadsheetProperties","maybeSheet","helperText","required","aria-disabled","RunWorkerButtons","memo","Transition","forwardRef","ref","Slide","direction","SessionExpiredAlert","sessionName","setRedirect","TransitionComponent","keepMounted","aria-describedby","DialogTitle","DialogContentText","WorkPage","handleSessionExpired","openSessionExpiredAlert","handleError","closeError","returnToLoginPage","showControls","LoadingPane","urlProvider","App","Provider","hashType","path","WorkPageWrapper","exact","LoginPageWrapper","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","document","getElementById"],"mappings":"mnBA+DYA,E,yEC/DNC,EAAS,0BAGMC,E,WAGjB,WAAYC,GAAqB,yBAFhBA,eAEe,EAC5BC,KAAKD,UAAYA,E,oDAIjB,OAAOC,KAAKD,UAAL,UAVG,4CAUH,YAAiCF,GAAWA,M,8CDTrDI,EAAmD,GAElD,SAASC,EAAKC,EAAcC,EAAuBC,GACtD,IAAKD,EACD,OAAO,EAGX,IAAME,EAAOC,KAAKC,UAAUJ,GAS5B,OAPIC,IAAYT,EAAYa,OAASJ,IAAYT,EAAYc,iBACzDC,aAAaC,QAAQT,EAAMG,GAC3BD,IAAYT,EAAYiB,SAAWR,IAAYT,EAAYc,iBAC3DI,eAAeF,QAAQT,EAAMG,GAEjCL,EAAYE,GAAQC,GAEb,EAGJ,SAASW,EAAgCZ,EAAca,GAC1D,IAAMC,EAAYhB,EAAYE,GAC9B,GAAIc,GAAaD,IAAcpB,EAAYiB,QACvC,OAAOI,EAGX,IAAIC,EAAyB,KAO7B,GALIF,IAAcpB,EAAYa,OAASO,IAAcpB,EAAYc,kBAC7DQ,EAAUP,aAAaQ,QAAQhB,IAC/Ba,IAAcpB,EAAYiB,SAAWG,IAAcpB,EAAYc,kBAC/DQ,EAAUJ,eAAeK,QAAQhB,KAEhCe,EACD,OAAO,KAGX,IAAME,EAAab,KAAKc,MAAMH,GAC9B,OAAKE,GAILnB,EAAYE,GAAQiB,EACbA,GAJI,KAOR,SAASE,EAAMnB,EAAcoB,GAQhC,OAPIA,IAAgB3B,EAAYa,OAASc,IAAgB3B,EAAYc,iBACjEC,aAAaa,WAAWrB,GACxBoB,IAAgB3B,EAAYiB,SAAWU,IAAgB3B,EAAYc,iBACnEI,eAAeU,WAAWrB,UAEvBF,EAAYE,IAEZ,G,SAQCP,O,iBAAAA,I,qBAAAA,I,sCAAAA,M,KE/DL,IAUK6B,EAVCC,EAIT,WAAYC,GAA+C,IAAvBC,EAAsB,uDAAJ,GAAI,yBAHjDA,aAGiD,OAFjDD,gBAEiD,EACtD3B,KAAK2B,WAAaA,EAClB3B,KAAK4B,QAAUA,I,SAIXH,O,qCAAAA,I,4CAAAA,M,SCyIAI,EA7ISC,E,WAGjB,WAAYC,GAAiC,yBAFpCA,oBAEmC,OAIpCC,KAAsB,KAJc,KAYpCC,OAAwB,KAZY,KAoBpCC,UAAqB,YAnBzBlC,KAAK+B,eAAiBA,E,wDA0BtB,SAAU/B,KAAKgC,OAAQhC,KAAKiC,U,8JAIrBjC,KAAKgC,OAAQhC,KAAKiC,O,sDAGrBE,EAAYC,EAAsB,YAAaxC,EAAYiB,U,uBAE3Db,KAAKqC,cAAcF,EAAUG,IAAKH,EAAUI,MAAOJ,EAAUK,U,6BAIjEL,EAAYC,EAAsB,YAAaxC,EAAYa,O,kEAI9BT,KAAKyC,cAAcN,EAAUG,K,SAC1D,QADMI,E,cACN,IAAIA,OAAJ,EAAIA,EAAgBC,UAChB3C,KAAKqC,cAAcF,EAAUG,IAAKH,EAAUI,MAAOJ,EAAUK,U,oLAGzCF,G,kGAEWM,IAAQ,CACnCC,OAAQ,MACRC,IAAK9C,KAAK+B,eAAegB,QAAU,cACnCC,QAAS,CACL,WAAW,cAAX,OAA0BV,GAC1B,mBAAoB,oB,UALtBW,E,SASAT,EAAWS,EAASC,MAAM,8D,yCAErB,CAACP,SAAS,EAAMH,SAAUA,EAAS,K,gCACvC,CAACG,SAAS,EAAOH,SAAU,c,2DAG3B,M,2LAIED,EAAeY,G,+FACLnD,KAAKoD,gBAAgBb,EAAOY,G,WAA7CF,E,SAEa,iBAAkBA,EAASD,Q,yCACnCnB,EAAYwB,O,UAGjBC,EAASL,EAASD,QAAQ,gBAC1BO,EAASD,EAAOJ,MAAM,uB,yCAGjBrB,EAAYwB,O,cAEjBf,EAAMiB,EAAO,G,UAEOvD,KAAKyC,cAAcH,G,WACzB,QADdkB,E,kDAEK3B,EAAYwB,O,WAClBG,EAAYb,Q,0CACNd,EAAY4B,oB,eAEvBzD,KAAKqC,cAAcC,EAAKC,EAAOiB,EAAYhB,U,kBAEpCX,EAAY6B,S,wLAGFpB,G,0EACZA,E,yCACMT,EAAY4B,oB,uBAEGzD,KAAKyC,cAAcH,G,UACzB,QADdkB,E,iDAEK3B,EAAYwB,O,UAClBG,EAAYb,Q,yCACNd,EAAY4B,oB,cAEvBzD,KAAKqC,cAAcC,EAAK,YAAakB,EAAYhB,U,kBAE1CX,EAAY6B,S,4IAGDpB,EAAaC,EAAeC,GAC9CJ,EAAW,YAAa,CAACE,MAAKC,QAAOC,YAAW5C,EAAYc,iBAC5DV,KAAKgC,KAAOM,EACZtC,KAAKiC,OAASM,EACdvC,KAAKkC,UAAYM,I,+BAIjBxC,KAAKgC,KAAO,KACZhC,KAAKiC,OAAS,KACdG,EAAY,YAAaxC,EAAYc,mB,+EAGX6B,EAAeY,G,iFAC5BP,IAAQ,CACjBE,IAAK9C,KAAK+B,eAAegB,QAApB,SACLF,OAAQ,OACRc,KAAK,YAAD,OAAcpB,EAAd,qBAAgCY,GACpCS,yBAAyB,EACzBC,QAAQ,EACRb,QAAS,CACL,eAAgB,sDAErBc,MAAK,SAAAC,GAAC,OAAIA,KAAG,kBAAM,Q,2KA/HtB,IAAK/D,KAAKgC,KACN,MAAM,IAAIN,EAAYD,EAAWuC,gBAAiB,oBACtD,OAAOhE,KAAKgC,O,4BAMZ,IAAKhC,KAAKiC,OACN,MAAM,IAAIP,EAAYD,EAAWuC,gBAAiB,oBACtD,OAAOhE,KAAKiC,S,+BAMZ,OAAOjC,KAAKkC,c,eAmHRL,O,qBAAAA,I,2CAAAA,I,kBAAAA,M,KC9IZ,IAEeoC,EAFCC,0B,sECED,SAASC,EAAkBC,GAAe,IAC9CC,EAAuDD,EAAvDC,WAAYC,EAA2CF,EAA3CE,UAAWC,EAAgCH,EAAhCG,SAAU/B,EAAsB4B,EAAtB5B,SAAUgC,EAAYJ,EAAZI,SAElD,OACI,cAAC,IAAMC,SAAP,UAEQF,EACI,eAAC,IAAME,SAAP,WACI,8HAAsBjC,KACtB,cAACkC,EAAA,EAAD,CAAQC,KAAK,SACLC,WAAS,EACTC,QAAQ,YACRC,QAASN,EACTO,MAAM,UAJd,mEAQJ,cAAC,IAAD,CACIC,SArBN,2EAsBMC,WAAW,0FACXC,UAAWb,EACXC,UAAWA,EACXa,MAxBT,6DAyBSC,YAAY,M,8BC1BrB,SAASC,EAAYjB,GAAe,IACxCkB,EAAgClB,EAAhCkB,KAAM1D,EAA0BwC,EAA1BxC,QAAS+C,EAAiBP,EAAjBO,KAAMY,EAAWnB,EAAXmB,QAE5B,OACI,cAAC,IAAMd,SAAP,UACI,cAACe,EAAA,EAAD,CACIF,KAAMA,EACNG,iBAAkB,IAClBC,aAAc,CAACC,SAAU,MAAOC,WAAY,UAC5CL,QAASA,EAJb,SAKI,cAAC,EAAD,CAAOM,SAAUlB,EAAMY,QAASA,EAAhC,SACK3D,QAOrB,SAASkE,EAAM1B,GACX,OAAO,cAAC,IAAD,aAAU2B,UAAW,EAAGlB,QAAQ,UAAaT,I,qCCnBzC,SAAS4B,EAAkB5B,GAAe,IAC9C6B,EAAwD7B,EAAxD6B,MAAOC,EAAiD9B,EAAjD8B,QAASC,EAAwC/B,EAAxC+B,UAAWrB,EAA6BV,EAA7BU,QADkB,EACWV,EAApBgC,gBADS,SAGpD,OACI,sBAAKD,UAAW,uBAAyBA,EAAzC,UACI,cAACzB,EAAA,EAAD,CAAQC,KAAK,SACLC,WAAS,EACTC,QAAQ,YACRE,MAAM,UACND,QAASA,EACTsB,SAAUF,GAAWE,EAL7B,SAMKH,IAGDC,GACA,cAACG,EAAA,EAAD,CAAkBtB,MAAM,YAAYuB,KAAM,GAAIH,UAAU,uB,WCsW5DI,EAaAC,ECjYG,cAAiF,IAAtEC,EAAqE,EAArEA,SAAUC,EAA2D,EAA3DA,WAAYR,EAA+C,EAA/CA,QAAS3B,EAAsC,EAAtCA,SAAUC,EAA4B,EAA5BA,SAAUhC,EAAkB,EAAlBA,SAAkB,EACjEmE,IAAMC,SAAS,IADkD,mBACpFrE,EADoF,KAC7EsE,EAD6E,OAE3DF,IAAMC,SAAS,IAF4C,mBAEpFzD,EAFoF,KAE1E2D,EAF0E,OAGrEH,IAAMC,SAAS,IAHsD,mBAGpFtE,EAHoF,KAG/EyE,EAH+E,KAiC3F,OAAOxC,EACC,eAAC,IAAME,SAAP,WACI,8HAAsBjC,KACtB,cAACkC,EAAA,EAAD,CAAQC,KAAK,SACLC,WAAS,EACTC,QAAQ,YACRC,QAASN,EACTO,MAAM,UAJd,+EAUJ,sBAAKoB,UAAW,iBAAhB,UACI,uBAAMA,UAAU,OAAOM,SAvBnC,SAAsBO,GAClBA,EAAEC,iBAEEf,GAGJO,EAAS,CAAClE,MAAOA,EAAOY,WAAUb,SAiB1B,UACI,cAAC4E,EAAA,EAAD,CACIf,UAAW,iBACXtB,QAAQ,WACRsC,OAAO,SACPvC,WAAS,EACTwC,GAAG,WACHC,MAAM,8FACNlH,KAAK,WACLmH,WAAS,EACTC,MAAOhF,EACP6D,SAAUF,EACVsB,SAtDpB,SAA+BR,GAC3B,IAAMO,EAAQP,EAAES,OAAOF,MACvBV,EAASU,GACTR,EAAO,OAoDK,cAACG,EAAA,EAAD,CACIf,UAAW,iBACXtB,QAAQ,WACRsC,OAAO,SACPvC,WAAS,EACTzE,KAAK,WACLkH,MAAM,uCACN1C,KAAK,WACLyC,GAAG,WACHM,aAAa,mBACbH,MAAOpE,EACPiD,SAAUF,EACVsB,SA7DpB,SAA+BR,GAC3B,IAAMO,EAAQP,EAAES,OAAOF,MACvBT,EAAYS,GACZR,EAAO,OA2DK,mBAAGZ,UAAU,6BAAb,gCACA,cAACe,EAAA,EAAD,CACIf,UAAW,iBACXtB,QAAQ,WACRsC,OAAO,SACPvC,WAAS,EACTzE,KAAK,MACLkH,MAAM,aACN1C,KAAK,WACLyC,GAAG,MACHG,MAAOjF,EACP8D,SAAUF,EACVsB,SApEpB,SAA0BR,GACtB,IAAMO,EAAQP,EAAES,OAAOF,MACvBR,EAAOQ,GACPV,EAAS,IACTC,EAAY,OAiEA,cAACd,EAAD,CAAmBG,UAAW,yBAA0BF,MAAM,iCAAQC,QAASQ,EAC5DN,SAAUF,OAG7BA,GACA,cAACG,EAAA,EAAD,CAAkBtB,MAAM,UAAUuB,KAAM,IAAKH,UAAU,iBC/FrEwB,EAAiB,CAAC,4DAyCTC,EAtCI,CACTC,KADS,WACD,OAAD,wGAELC,KAAKC,OAFA,0EAIF,IAAIC,SAAQ,SAAAC,GACfH,KAAKI,KAAK,eAAV,sBAA0B,sBAAAC,EAAA,sEAChBL,KAAKC,OAAOF,KAAK,CACnB7C,SAZF,2EAaEoD,cAAeT,EACfxC,MAZL,+DAaIkD,MAAMC,QAAQC,OALK,OAMtBN,IANsB,gDALrB,8CAgBbO,gBAjBe,WAiBI,IAAD,MAEd,iBAAOV,KAAKW,aAAZ,iBAAO,EAAYC,yBAAnB,iBAAO,EAA+BtD,kBAAtC,aAAO,EAA2CuD,OAGtDC,YAtBe,WAsBoB,IAAD,QAExBpG,EAAQ,UAAGsF,KAAKW,aAAR,iBAAG,EAAYC,kBAAkBG,mBAAjC,aAAG,EAA2CF,MAAMG,kBAAkBC,UACpF,OAAIvG,IAIJ,UAAOsF,KAAKW,aAAZ,iBAAO,EAAYC,kBAAkBG,mBAArC,aAAO,EAA2CF,MAAMG,kBAAkBE,aAGxEC,OAhCS,WAgCC,OAAD,sIAELnB,KAAKW,aAFA,iBAEL,EAAYC,yBAFP,aAEL,EAA+BQ,UAF1B,+CC1BEC,E,kDACjB,WAAY/E,GAAe,IAAD,8BACtB,cAAMA,IAwBVgF,gBAzB0B,uCAyBR,WAAOC,GAAP,eAAAlB,EAAA,6DACd,EAAKmB,SAAS,CAACC,eAAe,IADhB,SAGY,EAAKC,cAAcH,GAH/B,OAGRI,EAHQ,OAKd,EAAKH,SAAS,CAACC,eAAe,IALhB,KAONE,EAPM,cAQL5H,EAAY6B,QARP,SAgBL7B,EAAYwB,MAhBP,UAuBLxB,EAAY4B,mBAvBP,0BASN,EAAK6F,SAAS,CACVI,aAAc,qJACdC,WAAW,EACXC,UAAW,UACXC,eAAe,IAbb,oCAiBN,EAAKP,SAAS,CACVI,aAAc,gMACdC,WAAW,EACXC,UAAW,UApBT,6BAwBN,EAAKN,SAAS,CACVI,aAAc,sJACdC,WAAW,EACXC,UAAW,UA3BT,4CAzBQ,wDAyD1BJ,cAzD0B,uCAyDV,WAAOH,GAAP,SAAAlB,EAAA,0DACRkB,EAAY/G,IADJ,gCAEK,EAAK8B,MAAM0F,QAAQC,eAAeV,EAAY/G,KAFnD,mDAIR+G,EAAY9G,QAAS8G,EAAYlG,SAJzB,gCAKK,EAAKiB,MAAM0F,QAAQE,WAAWX,EAAY9G,MAAO8G,EAAYlG,UALlE,wEAOLtB,EAAY4B,oBAPP,2CAzDU,wDAmE1BwG,iBAAmB,WACf,EAAKX,SAAS,CAACK,WAAW,KApEJ,EAuE1BO,qBAAuB,WACnB,EAAKZ,SAAS,CAACa,kBAAkB,KAxEX,EA2E1BC,wBAA0B,SAAC7B,GACvBD,QAAQC,MAAMA,GAEd,EAAKe,SAAS,CACVK,WAAW,EACXC,UAAW,QACXF,aAAc,kMAjFI,EAqF1BW,UAAY,WACR,EAAKf,SAAS,CAACgB,UAAU,KAtFH,EAyF1BC,gBAAkB,WACd,EAAKnG,MAAM0F,QAAQb,SACnB,EAAKK,SAAS,CACVO,eAAe,EACfH,aAAc,+HACdE,UAAW,UACXD,WAAW,KA/FO,EAmG1Ba,mBAnG0B,sBAmGL,sBAAArC,EAAA,sEACXP,EAAWqB,SADA,OAEjB,EAAKK,SAAS,CACVa,kBAAkB,EAClBP,UAAW,UACXF,aAAc,mHACdC,WAAW,IANE,2CAhGjB,EAAKc,MAAQ,CACTC,YAAY,EACZb,eAAe,EACfM,kBAAkB,EAClBG,UAAU,EACVf,eAAe,EACfI,WAAW,EACXD,aAAc,GACdE,UAAW,SAXO,E,kMAiBhB5J,KAAKoE,MAAM0F,QAAQa,kB,OACzB/C,EAAWC,OAELgC,EAAgB7J,KAAKoE,MAAM0F,QAAQc,YACnCT,EAAmBvC,EAAWY,kBACpCxI,KAAKsJ,SAAS,CAACoB,YAAY,EAAOb,gBAAeM,qB,qIAwFjD,OACI,sBAAKhE,UAAU,aAAf,UACKnG,KAAKyK,MAAMH,UAAY,cAAC,IAAD,CAAUO,GAAG,UACrC,eAACC,EAAA,EAAD,CAAWC,UAAU,OAAOC,SAAS,KAArC,UACI,uEACA,wHACA,0WAAwE,uBAAxE,gmBAE2B,uBAF3B,uSAIA,8jBACiB,uBADjB,+YAGA,kKACA,gbAAkF,uBAAlF,+aACuF,uBADvF,2TAGA,uBACA,mBAAG7E,UAAW,eAAd,gSACA,eAAC8E,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAQ,eAAehF,UAAW,yBAAlD,UACI,cAAC8E,EAAA,EAAD,CAAMG,MAAI,EAACC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GAApC,SACI,cAAC,EAAD,CAAc/E,SAAUzG,KAAKoJ,gBACflD,QAASlG,KAAKyK,MAAMC,WACpBnG,SAAUvE,KAAKyK,MAAMZ,cACrBrF,SAAUxE,KAAKuK,gBACf/H,SAAUxC,KAAKoE,MAAM0F,QAAQtH,SAC7BkE,WAAY1G,KAAKyK,MAAMlB,kBAEzC,eAAC0B,EAAA,EAAD,CAAMG,MAAI,EAACjF,UAAU,eAArB,UACI,cAAChC,EAAD,CAAmBE,WAAYrE,KAAKkK,qBACjB3F,SAAUvE,KAAKyK,MAAMN,iBACrB3H,SAAUoF,EAAWgB,cACrBpE,SAAUxE,KAAKwK,mBACflG,UAAWtE,KAAKoK,0BACnC,6BAGR,cAACU,EAAA,EAAD,CAAW3E,UAAU,qBAArB,SACI,cAACzB,EAAA,EAAD,CAAQG,QAAQ,YACRC,QAAS9E,KAAKqK,UACdjE,UAAWpG,KAAKyK,MAAMZ,gBAAkB7J,KAAKyK,MAAMN,iBACnDpF,MAAM,YAHd,yFAOJ,cAACM,EAAD,CAAaC,KAAMtF,KAAKyK,MAAMd,UACjB/H,QAAS5B,KAAKyK,MAAMf,aACpB/E,KAAM3E,KAAKyK,MAAMb,UACjBrE,QAASvF,KAAKiK,6B,GA/JRtD,IAAM8E,WCL9B,aACX,OACI,cAAC,EAAQC,SAAT,UAEQ,SAAAC,GAAO,OAAI,cAAC,EAAD,CAAW7B,QAAU6B,EAAiC7B,c,2BJD5D8B,I,kBAIjB,WAAY9B,EAAkB/H,GAAiC,yBAHtD+H,aAGqD,OAF7C/H,oBAE6C,EAC1D/B,KAAK8J,QAAUA,EACf9J,KAAK+B,eAAiBA,E,8GAItB8J,EACAC,EACAC,EACAC,G,gFAEMC,E,UAAejM,KAAK8J,QAAQvH,M,0BAAuBsJ,E,YAAQC,E,YAAYC,E,YAAUC,KACjFE,EAAc9J,EAAyB6J,EAAWrM,EAAYa,Q,yCAEzDyL,G,uBAGSlM,KAAKmM,wBAAwBN,EAAMC,EAAUC,EAAQC,G,cAAnEI,E,gBACepM,KAAKqM,2BACtBR,EACAC,EACAC,EACAC,EACAI,G,cALE7I,E,OAONnB,EAAW6J,EAAW1I,EAAQ3D,EAAYa,O,kBACnC8C,G,wMAIPsI,EACAC,EACAC,EACAC,EACAI,G,0FAEME,E,gBAAuBT,E,qBAAiBC,E,mBAAmBC,E,kBAAgBK,E,4BAAyBA,E,aACtGJ,E,iCACqBhM,KAAKuM,oBACtB,2BAA6BD,G,OAD3BE,E,OAGAC,EAAcD,EAAOtL,Q,eACXuL,G,IAAhB,2BAA6B,QACvBT,UAAW,E,uDAEVS,G,yBAEczM,KAAKuM,oBACtB,+BAAiCD,G,QAD/BE,E,OAGAC,EAAcD,EAAOtL,Q,eACXuL,G,IAAhB,2BAA6B,QACvBT,UAAW,E,uDAEVS,G,uMAKXZ,EACAC,EACAC,EACAC,G,kFAEMU,EAAkBV,EAAW,YAAc,GAC3CM,EAAc,gBAAST,EAAT,qBAA0BC,EAA1B,mBAA6CC,GAAWW,E,SACxD1M,KAAKuM,oBACrB,gCAAkCD,G,cADhCF,E,yBAGCA,G,oMAGmBO,G,mHAEZ3M,KAAK4M,qBAAqBD,EAAY,UAAW,W,iEACjD3M,KAAK4M,qBAAqBD,EAAY,UAAW,gB,kEACjD3M,KAAK4M,qBAAqBD,EAAY,aAAc,W,oEACpD3M,KAAK4M,qBAAqBD,EAAY,aAAc,gB,4CAJ5DE,E,4CAOAC,EAAgD,G,eACtCD,G,IAAhB,2BAAWE,EAAe,QAChBC,EAAeF,EAAeC,EAAEE,cAAgB,GACtDH,EAAeC,EAAEE,aAAjB,2BAAoCD,GAAiBD,G,uDAGlDG,OAAOC,KAAKL,GAAgBM,KAAI,SAAAC,GAAC,OAAIP,EAAeO,O,4LAI3DV,EACAW,EACAC,G,0FAEOvN,KAAKwN,6BACRb,EAAWc,eACXd,EAAWX,SACXW,EAAWe,eACXf,EAAWgB,QACXL,EACAC,I,uMAKJE,EACAzB,EACA4B,EACAC,EACAP,EACAC,G,8FACAO,E,gCACAC,E,gCAEMC,EAAYhC,EAAQ,oBACP6B,GADO,oBAEPD,G,kBACZ5N,KAAKuM,oBACR,wDAAiDkB,EAAjD,YAAmEO,GAAnE,oBACaV,EADb,kCAC+CQ,GAD/C,wBAE8B,iBAAbP,GAFjB,oDAG6CQ,K,gNAIfpB,G,mGAEpB3M,KAAKiO,6BAA6BtB,EAAY,UAAW,W,iEACzD3M,KAAKiO,6BACXtB,EACA,UACA,gB,kEAEM3M,KAAKiO,6BACXtB,EACA,aACA,W,oEAEM3M,KAAKiO,6BACXtB,EACA,aACA,gB,wEAEM3M,KAAKiO,6BAA6BtB,EAAY,WAAY,W,wEAC1D3M,KAAKiO,6BACXtB,EACA,WACA,gB,wEAEM3M,KAAKiO,6BACXtB,EACA,qBACA,W,wEAEM3M,KAAKiO,6BACXtB,EACA,qBACA,gB,8UAMRA,EACAW,EACAC,G,8EAEMtB,EAAY,UAAGjM,KAAK8J,QAAQvH,MAAhB,8BAA2CoK,EAAWc,gBAAtD,WACVd,EAAWX,SADD,YACaW,EAAWe,eADxB,YAC0Cf,EAAWgB,QADrD,YACgEL,EADhE,YAC4EC,KACxFrB,EAAc9J,EAA4B6J,EAAWrM,EAAYa,Q,yCAE5DyL,G,uBAGUlM,KAAKkO,+BACtBvB,EAAWc,eACXd,EAAWX,SACXW,EAAWe,eACXf,EAAWgB,QACXL,EACAC,G,cANEhK,E,OAQNnB,EAAW6J,EAAW1I,EAAQ3D,EAAYa,O,kBACnC8C,G,yMAIPkK,EACAzB,EACA4B,EACAC,EACAP,EACAC,G,8FAEMY,EAAanC,EAAW,UAAY,GACpCgC,EAAYhC,EAAW6B,EAAYD,E,SAClB5N,KAAKoO,gBAAL,gCACMX,EADN,YACwBO,EADxB,oBAC6CG,EAD7C,YAC2Db,EAD3D,YACuEC,I,UADxFtK,E,OAIAoL,EAAS,6BACTC,EAAS,KAKY,KAJrBC,EAActL,EACfuL,MAAM,QACNpB,KAAI,SAAAL,GAAC,OAAIA,EAAE0B,UACXC,QAAO,SAAA3B,GAAC,OAAIA,EAAE4B,WAAWN,OACdO,O,uBACN,IAAIvL,MACN,wF,eAIFwL,EACFtO,KAAKc,MACDkN,EAAY,GAAGO,OACXT,EAAOO,OACPL,EAAY,GAAGK,OAASP,EAAOO,OAASN,EAAOM,UAElD,GAEHG,EAAa,iBACbxL,EAASsL,EACVH,QAAO,SAAAM,GAAC,OAAIA,EAAEC,MAAQD,EAAEC,KAAKN,WAAWI,MACxC3B,KAAI,SAAA4B,GAAC,MAAK,CACPC,KAAMD,EAAEC,KACRC,kBAAmBF,EAAEC,KAAKH,OAAOC,EAAWH,QAC5CO,cAAeH,EAAEG,kB,kBAElB5L,G,qMAIP0J,EACAmC,EACAC,EACA1B,EACA2B,EACAC,G,8EAEM5L,E,kBAAkBsJ,E,qBAAwBmC,E,iBAC5CI,MAAMH,GAAQ,GAAKA,EAAKI,W,oBAChB9B,E,wBAAuB2B,E,+BAAkCC,G,kBAC9DvP,KAAKuM,oBAAL,+BAEH,CACI1J,OAAQ,OACRc,OACArD,MAAM,GAEV,CACI,eAAgB,sD,uMAMxB2M,EACAN,G,8FACA+C,E,+BAAiCnJ,EAAeoJ,UAChDrC,E,+BAAqB,UAEf3J,E,sBAAsB+L,E,qBAA2BpC,E,2BAA2BX,EAAWc,e,sBAA4BR,G,SACnHjN,KAAKoO,gBAAL,6BAEF,CACIvL,OAAQ,OACRc,OACArD,MAAM,GAEV,CACI,eAAgB,qD,4LAKFqM,G,iFAEhB3M,KAAK4P,iBAAiBjD,EAAY,UAAW,gB,uLAUnDA,EACAW,EACAC,G,0FAEOvN,KAAK6P,yBACRlD,EAAWc,eACXd,EAAWX,SACXW,EAAWe,eACXf,EAAWgB,QACXL,EACAC,I,mMAKJE,EACAzB,EACA4B,EACAC,EACAP,EACAC,G,kFAEMY,EAAanC,EAAW,UAAY,GACpCgC,EAAYhC,EAAQ,oBACP6B,GADO,oBAEPD,GACbjK,EACF,yBAAkB8J,EAAlB,YAAoCO,GAApC,oBACaV,EADb,wDAE8B,iBAAbC,GAFjB,iD,kBAIGvN,KAAKoO,gBAAL,iCACuBD,GAC1B,CACItL,OAAQ,OACRc,OACArD,MAAM,GAEV,CACI,eAAgB,sD,oMAMxBwP,EACAC,EACA/M,G,uFAEuBhD,KAAKoO,gBAAwB0B,EAAKC,EAAS/M,G,cAA5DC,E,yBAEC1C,KAAKc,MAAM4B,I,0LAIlB6M,EACAC,EACA/M,G,uFAEuBJ,IAAQ,yBAC3BC,OAAQ,OACLkN,GAFuB,IAG1BjN,IAAK9C,KAAK+B,eAAegB,QAAU+M,EACnC9M,QAAQ,aACJ,WAAW,cAAX,OAA0BhD,KAAK8J,QAAQxH,KACvC,mBAAoB,kBACjBU,M,YAPLC,E,QAWO+M,WAAWrB,WAAW,mB,sBACzB,IAAIjN,EAAYD,EAAWuC,gBAAiB8L,EAAM,iB,gCAGrD7M,G,6HAIHsD,O,0BAAAA,I,2BAAAA,I,uDAAAA,I,6BAAAA,I,8CAAAA,I,wCAAAA,I,8CAAAA,I,kCAAAA,I,kCAAAA,I,6BAAAA,M,cAaAC,O,eAAAA,I,oBAAAA,M,KKtYL,SAASyJ,GAAeC,GAE3B,IAAMC,EAASrI,KAAKC,OAAOoI,OAFoC,4CAI/D,WAAyBC,GAAzB,eAAAjI,EAAA,sEAC2BgI,EAAOE,aAAaC,OAAO3H,IAAI,CAClDuH,gBACAE,UAHR,cACUnN,EADV,yBAKWA,EAASM,QALpB,4CAJ+D,sBA0C/D,MAAO,CACHgN,UA3C2D,4CA4C3DC,WAhCJ,SAAoBJ,EAAeE,GAA2C,IAA1BG,EAAyB,wDACnEC,EAAmBD,EAAkB,eAAiB,MACtDE,EAAc,CAChBL,UAEJ,OAAOH,EAAOE,aAAaC,OAAOM,OAAO,CACrCV,gBACAE,QACAM,mBACAC,iBAwBJE,YApBJ,SACIT,EACAE,GAED,IADCG,EACF,wDACQC,EAAmBD,EAAkB,eAAiB,MACtDE,EAAc,CAChBL,UAEJ,OAAOH,EAAOE,aAAaC,OAAOQ,OAAO,CACrCZ,gBACAE,QACAM,mBACAC,kBAWL,SAAeI,GAAtB,mC,8CAAO,WAAwCb,GAAxC,mBAAA/H,EAAA,6DAEGgI,EAASrI,KAAKC,OAAOoI,OAFxB,SAIeA,EAAOE,aAAa1H,IAAI,CAACuH,kBAJxC,cAIGc,EAJH,OAKGC,EAAa1Q,KAAKc,MAAM2P,EAAIrN,MAAMwM,OALrC,kBAMIc,EAAW7D,KAAI,SAAAL,GAAC,OAAIA,EAAEmE,eAN1B,4C,sBC7CA,SAASC,GAAgBC,GAC5B,OACIA,GACAA,EACKC,cACAC,QAAQ,SAAK,UACbA,QAAQ,sDAAyB,IAIvC,SAASC,GAAkBC,EAAYC,GAC1C,OAAON,GAAgBK,KAAQL,GAAgBM,GAG5C,SAASC,GAAc3E,GAC1B,OAAO4E,WAAW5E,GAAKA,EAAEuE,QAAQ,IAAK,MChB1C,IAAMM,GAAoD,CACtD,IAAKrL,EAAeoJ,UACpB,0DAAcpJ,EAAesL,UAC7B,uGAAwBtL,EAAeuL,wBACvC,oDAAavL,EAAewL,YAC5BC,uFAAgBzL,EAAe0L,oBAC/BC,2EAAc3L,EAAe4L,iBAC7B,0DAAc5L,EAAe6L,oBAC7B,+FAAqB7L,EAAe8L,cACpC,sHAAwB9L,EAAe+L,cACvCC,iCAAOhM,EAAeiM,YAGnB,SAASC,GAAoBC,GAChC,GAAc,OAAVA,QAA4BC,IAAVD,EAClB,OAAO,KAGX,cAAgBxF,OAAOC,KAAKyE,IAA5B,eAA6C,CAAxC,IAAIgB,EAAG,KACR,GAAIrB,GAAkBqB,EAAKF,GACvB,OAAOd,GAAegB,GAI9B,OAAOrM,EAAeoJ,UAGnB,SAASkD,GACZH,GAEA,GAAc,OAAVA,QAA4BC,IAAVD,EAClB,OAAO,KAGX,cAAgBxF,OAAOC,KAAKyE,IAA5B,eAA6C,CAAxC,IAAIgB,EAAG,KACR,GAAIhB,GAAegB,KAASF,EACxB,OAAOE,EAIf,MAAO,IC/BJ,SAAeE,GAAtB,qC,8CAAO,WACH5C,EACA6C,GAFG,qDAAA5K,EAAA,6DAGH6K,EAHG,+BAGqB,EACxBC,EAJG,+BAIsB,EACzBC,EALG,+BAKsB,KACzBC,EANG,+BAM2B,KAExBC,EAAQC,GAAyBnD,GARpC,SAUiBkD,EAAM7C,UAAUwC,GAVjC,sBAU6CzC,OAV7C,2BAUuD,GAVvD,QAUGgD,EAVH,KAYG/P,EAA0B,GAZ7B,eAae+P,GAbf,IAaH,2BAAWC,EAAa,QACdC,EAAWD,EAAIP,GACfS,EAAYF,EAAIN,GAChB7L,EAAiB,OAAZ8L,EAAmBK,EAAIL,GAAW,KACvCQ,EACe,OAAjBP,EACMV,GAAoBc,EAAIJ,IACxB,KACNK,GAAYC,GACZlQ,EAAOoQ,KAAK,CACRH,WACAC,YACArM,GAAIA,EACJsM,QAASA,EACTxC,WAAYqC,IA3BrB,uDA+BIhQ,GA/BJ,6C,sBCJQ,SAAeqQ,GAA9B,qC,8CAAe,WACX1D,EACA2D,GAFW,2BAAA1L,EAAA,sEAIQ2L,GAA6B5D,EAAe2D,GAJpD,cAILP,EAJK,OAKLS,EAASC,GAAUV,GAEnBW,EAAUC,GAAeH,GACzBI,EAAYC,GAAeP,EAAWI,GACtCI,EAAuBC,GAAyBP,EAAQE,GACxDM,EAAmBC,GACrBlB,EACAW,EACA,MAbO,UAgBkBQ,GACzBvE,EACAiE,EACAF,EAAQS,eAAiBT,EAAQU,KACjCV,EAAQW,YAAcX,EAAQU,KAC9B,KACAV,EAAQY,cAAgBZ,EAAQU,MAtBzB,eAgBLG,EAhBK,yBAyBJ,CACHA,iBACAP,mBACAF,yBA5BO,6C,+BAgCAP,G,mFAAf,WACI5D,EACA2D,GAFJ,iBAAA1L,EAAA,6DAIUiL,EAAQC,GAAyBnD,GAJ3C,SAKwBkD,EAAM7C,UAAUsD,EAAY,aALpD,cAKUP,EALV,OAMShD,OANT,kBAOWgD,GAAQ,MAPnB,4C,sBAUA,SAASU,GAAUV,GACf,IAAMS,EAAST,GAAQA,EAAK,GAC5B,IAAKS,EAAQ,MAAM,IAAI1Q,MAAJ,oCACnB,OAAO0Q,EAGX,SAASG,GAAeH,GACpB,IAMMgB,EAAmBhB,GAAUA,EAAO3G,KAAI,SAACL,GAAD,OAAOoE,GAAgBpE,MAC/DiI,EAAmBD,EAAiBE,QACtC9D,GAR2B,mEAUzB+D,EAAsBH,EAAiBE,QACzC9D,GAV8B,4FAY5BgE,EAAqBJ,EAAiBE,QACxC9D,GAZ6B,4GAc3BiE,EAAoCL,EAAiBE,QACvD9D,GAduC,kHAgBrCkE,EAAsCN,EAAiBE,QACzD9D,GAhByC,kHAmB7C,GACIgE,EAAqB,GACrBH,EAAmB,GACnBE,EAAsB,GACtBF,EAAmBG,GACnBD,EAAsBC,GAC+B,IAArDG,KAAKC,IAAIL,EAAsBF,IAC/BI,EAAoC,GACpCC,EAAsC,GACtCD,GAAqCD,GACrCE,GAAuCF,GACvCE,IACAD,EAAoC,EAEpC,MAAM,IAAI/R,MAAJ,0BAIV,MAAO,CACHuR,YAAaI,EACbN,eAAgBQ,EAChBL,cAAeM,EACfK,oBAAqBJ,EACrBK,sBAAuBJ,EACvBV,KATcW,KAAKI,IAAIV,EAAkBE,GAUzCS,MATeR,GAavB,SAASf,GAAeP,EAAmBI,GACvC,IAAM2B,EAAaC,OAAOC,aAAa,IAAIC,WAAW,GAAK9B,EAAQU,MAC7DqB,EAAcH,OAAOC,aAAa,IAAIC,WAAW,GAAK9B,EAAQ0B,OACpE,MAAM,GAAN,OAAU9B,EAAV,YAAuB+B,EAAvB,aAAsCI,GAG1C,SAAS1B,GAAyBP,EAAkBE,GAEhD,IADA,IAAMI,EAA8C,GAC3C4B,EAAQhC,EAAQU,KAAMsB,GAAShC,EAAQ0B,MAAOM,IAE/CA,IAAUhC,EAAQW,aAClBqB,IAAUhC,EAAQS,gBAClBuB,IAAUhC,EAAQY,eACjBd,EAAOkC,IAIZ5B,EAAqBV,KAAK,CACtBuC,eAAgB,CAACnC,EAAOkC,IACxBE,cAAeF,EAAQhC,EAAQU,OAIvC,IAjBkE,iBAiB7D,IAAMyB,EAAM,KACb,GAAqC,IAAjCA,EAAOF,eAAetH,OAAc,CACpC,IAAMyH,EAAchC,EAAqB3F,QACrC,SAACM,GAAD,OACgC,IAA5BA,EAAEkH,eAAetH,QACjB2C,GACIvC,EAAEkH,eAAe,GACjBE,EAAOF,eAAe,OAGlC,GAAIG,EAAYzH,OAAS,EAAG,CACxBwH,EAAOE,WAAaD,EAAYzH,OAChC,IACI,IAAI2H,EAAa,EACjBA,EAAaF,EAAYzH,OACzB2H,IAEAF,EAAYE,GAAYA,WAAaA,KAjBrD,MAAqBlC,EAArB,eAA4C,IAuB5C,OAAOA,EAGX,SAASG,GACLlB,EACAW,EACAuC,GAYA,IAVA,IAAMjT,EAA2B,CAC7BpD,KAAM,GACN0L,KAAM,EACNC,SAAUtF,EAASiQ,KACnB1K,OAAQ,EACRC,UAAU,EACV0K,sBAAuBnQ,EAAeoJ,UACtC6G,qBAAsB,MAGjBG,EAAI,EAAGA,EAAIrD,EAAK1E,OAAQ+H,IAAK,CAAC,IAAD,IAC5B/D,EAAG,UAAGU,EAAKqD,GAAG1C,EAAQuB,4BAAnB,aAAG,EAAsC/G,OAClD,IAAKmE,EACD,MAGJgE,GAA6BrT,EAAQqP,EAD1B,UAAGU,EAAKqD,GAAG1C,EAAQwB,8BAAnB,aAAG,EAAwChH,QAK1D,OADAlL,EAAOiT,qBAAuBA,EACvBjT,EAGX,SAASqT,GACLR,EACAxD,EACArL,GAEA,GAAIgK,GAAkBqB,EAAK,gEACnBrL,IACA6O,EAAOjW,KAAOoH,QAEf,GAAIgK,GAAkBqB,EAAK,sBAC1BrL,IACA6O,EAAOpK,SAAmC,iBAAxBzE,EAAM8J,oBAEzB,GAAIE,GAAkBqB,EAAK,sBAC1BrL,IACA6O,EAAOvK,KAAOgL,SAAStP,EAAM8J,cAAe,UAE7C,GAAIE,GAAkBqB,EAAK,8CAC1BrL,IAC4B,+CAAxBA,EAAM8J,cACN+E,EAAOtK,SAAWtF,EAASiQ,KACI,qDAAxBlP,EAAM8J,gBACb+E,EAAOtK,SAAWtF,EAASsQ,cAGhC,GAAIvF,GAAkBqB,EAAK,6BAC9B,GAAIrL,EAAO,CACP,IAAMwP,EAAaxP,EAAM8J,cAAc5C,OAEnC2H,EAAOrK,OADQ,sDAAfgL,EACgB,EAEAF,SAAStP,EAAM8J,cAAe,UAGnD,GAAIE,GAAkBqB,EAAK,+KAAoC,CAAC,IAAD,EAClEwD,EAAOM,sBAAP,UACIjE,GAAoBlL,UADxB,QACkChB,EAAeoJ,W,qICvN1C,SAASqH,GAAW5S,GAAyB,IACjD6B,EAAkC7B,EAAlC6B,MAAOgR,EAA2B7S,EAA3B6S,MADyC,EACd7S,EAApB8S,iBADkC,SAGjDC,EACF,cAACC,GAAA,EAAD,CAAerM,UAAU,MAAM3D,GAAG,wBAAwBiQ,QAASpR,EAAnE,SACKA,IAIT,OACI,cAACqR,GAAA,EAAD,CACIvM,UAAU,MACVwM,kBAAgB,wBAChBC,UAAWL,EACXhR,UAAW,sBAJf,SAMQ8Q,EAAMrI,OACF6I,GAAeR,EAAOC,GACtB,cAACQ,GAAA,EAAD,CAAUvR,UAAW,eAArB,SACI,cAACwR,GAAA,EAAD,CAAcC,QAAQ,iBAO9C,SAASH,GAAeR,EAA0BC,GAC9C,OAAOD,EAAM7J,KAAI,SAAChC,EAAM6K,GAAP,OACb,cAAC4B,GAAD,CACMzM,KAAMA,EACN8L,UAAWA,GAFNjB,MAMnB,SAAS4B,GAAT,GAA6C,IAA9BzM,EAA6B,EAA7BA,KAAM8L,EAAuB,EAAvBA,UAAuB,EAChBvQ,IAAMC,UAAUsQ,GADA,mBACjC5R,EADiC,KAC3BwS,EAD2B,KAGjC7R,EAAsBmF,EAAtBnF,MAAO8R,EAAe3M,EAAf2M,YAERC,EAAcD,GAAeA,EAAYnJ,OAAS,EAExD,OACI,eAAC,IAAMnK,SAAP,WACI,eAACiT,GAAA,EAAD,CAAUO,QAAM,EAACnT,QAAS,kBAAMgT,GAASxS,IAAOa,UAAW,gBAA3D,UACI,cAAC+R,GAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACP,GAAA,EAAD,CAAcC,QAAS3R,IACtB+R,IAAgB1S,EAAO,cAAC6S,GAAA,EAAD,IAAgB,cAACC,GAAA,EAAD,QANhD,OASQL,QATR,IASQA,OATR,EASQA,EAAa3K,KAAI,SAACiL,EAAYpC,GAAb,OACb,cAACqC,GAAD,eAAgB,CAACrC,QAAO3Q,OAAMW,MAAOoS,EAAWpS,MAAOsS,QAASF,EAAWE,iBAM/F,SAASD,GAAT,GAAqE,IAAhDrC,EAA+C,EAA/CA,MAAOhQ,EAAwC,EAAxCA,MAAOX,EAAiC,EAAjCA,KACzBP,EAD0D,EAA3BwT,SACZ,eAEzB,OACI,cAACC,GAAA,EAAD,CAAsBC,GAAInT,EAAMoT,QAAQ,OAAOC,eAAa,EAA5D,SACI,cAACrB,GAAA,EAAD,CAAMvM,UAAU,MAAM6N,gBAAc,EAApC,SACI,eAAClB,GAAA,EAAD,CAAUvR,UAAW,eAAiBpB,EAAtC,UACI,cAACmT,GAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACP,GAAA,EAAD,CAAcC,QAAS3R,UANpBgQ,GCjER,SAAe4C,GAA9B,qC,8CAAe,WAA2CC,EAAgBvE,GAA3D,eAAApM,EAAA,sEACkB2Q,EAAOC,yBAChCxE,EAAiB1I,KACjB0I,EAAiBzI,SACjByI,EAAiBxI,OACjBwI,EAAiBvI,UALV,cACLgN,EADK,yBAQJA,EAAetK,QAClB,SAACuK,GAAD,OACI1H,GAAkB0H,EAAEtM,WAAY4H,EAAiBpU,SAC/CoU,EAAiBiC,sBACfjC,EAAiBiC,qBAAqByC,QAZvC,4C,6BCDA,mBAA6D,IAAlDC,EAAiD,EAAjDA,QAASC,EAAwC,EAAxCA,cAAeC,EAAyB,EAAzBA,gBAC9C,OACI,eAACnO,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAQ,eAAxB,UACI,cAACF,EAAA,EAAD,CAAMG,MAAI,EAAV,SACI,cAAC1G,EAAA,EAAD,CAAQG,QAAQ,YACRuB,UAAW8S,EACXpU,QAASqU,EACTpU,MAAM,UAHd,gJAOJ,cAACkG,EAAA,EAAD,CAAMG,MAAI,EAAV,SACI,cAAC1G,EAAA,EAAD,CAAQG,QAAQ,YACRuB,UAAW8S,EACXpU,QAASsU,EACTrU,MAAM,YAHd,6FCXT,SAASsU,GAAMC,GAClB,OAAOA,EAAIjI,cAAcC,QAAQ,SAAK,UAAKA,QAAQ,OAAQ,KAAK7C,O,ICG/C8K,G,WAMjB,WAAYT,EAAgBU,EAAgBzJ,GAA2B,yBALtD+I,YAKqD,OAJrD/I,aAIqD,OAH7DyJ,YAG6D,OAF9DC,eAAyB,EAG7BzZ,KAAK8Y,OAASA,EACd9Y,KAAKwZ,OAASA,EACdxZ,KAAK+P,QAAUA,E,qDAIf/P,KAAKyZ,eAAgB,I,kCAIrB,OAAOzZ,KAAKwZ,S,kFAGSE,EAAkCC,G,wFAEnD7E,EAGA4E,EAHA5E,eACAP,EAEAmF,EAFAnF,iBACAF,EACAqF,EADArF,qB,wBAIyBsF,G,gHAAdhN,E,iBACD,EAAKiN,2BACPjN,EACAmI,EAAepG,QAAO,SAAC3B,GAAD,OAClBwE,GAAkBxE,EAAE0G,UAAW9G,EAAWkN,UAE9CtF,EAAiBmC,sBACjBrC,G,WAEA,EAAKoF,c,sbAKbzZ,KAAKwZ,OAAOjR,MAAZ,M,0NAKJoE,EACAmI,EACA4B,EACArC,G,oFAE8B,IAA1BS,EAAelG,O,wDACnB5O,KAAKwZ,OAAOM,IAAZ,6BAAsCnN,EAAWkN,QACjD7Z,KAAKwZ,OAAOM,IAAI,I,SAEa9Z,KAAK8Y,OAAOiB,gCACrCpN,G,UADEuJ,E,OAIDlW,KAAKga,iCACF9D,EACA7B,G,kEAMkBrU,KAAK8Y,OAAOmB,wBAClCtN,G,eADEuN,E,SAOFla,KAAKma,cAAcrF,EAAgBoF,GAHnCE,E,EAAAA,eACAC,E,EAAAA,sBACAC,E,EAAAA,mBAEJta,KAAKua,kBACDH,EACAC,EACAC,GAEJta,KAAKwZ,OAAOM,IAAI,I,UAEV9Z,KAAKwa,yBACP7N,EACAyN,EACA/F,EACA6B,G,eAEJlW,KAAKwZ,OAAOM,IAAI,I,UAEV9Z,KAAKya,sCACPH,EACA3N,EACA+J,G,WAEJ1W,KAAKwZ,OAAOM,IAAI,KAEZ9Z,KAAK+P,QAAQ7P,K,kCACPF,KAAK8Y,OAAO4B,oBAAoB/N,G,QAG1C3M,KAAKwZ,OAAOM,IAAI,I,qKAIhB5D,EACA7B,GACD,IAAD,iBACuBA,GADvB,IACE,2BAA2C,CAAC,IAAjC+B,EAAgC,QACvC,IAAKpW,KAAK2a,yBAAyBvE,EAAQF,GACvC,OAAO,GAHjB,8BAME,OAAO,I,wFAIPvJ,EACAE,EACAwH,EACA6B,G,qFAEM0E,EAA0C,G,eAE1B/N,G,gEAAXgO,E,iBACc7a,KAAK8a,wBACtBnO,EACAkO,EACAxG,EACA6B,G,OAJE6E,E,YAMyBpI,IAA3BiI,EAAeG,KACfH,EAAeG,GAAU,GAE7BH,EAAeG,K,+IAInB,IADA/a,KAAKwZ,OAAOM,IAAI,0BAChB,MAAgB5M,OAAOC,KAAKyN,GAA5B,eAAWvN,EAAkC,KACzCrN,KAAKwZ,OAAOM,IAAZ,YAAqBzM,EAArB,cAA4BuN,EAAevN,K,oNAK/CV,EACAkO,EACAxG,EACA6B,G,qGAEI8E,EAAU,EACVC,EAAS,EAEPC,EAAQ,G,eACO7G,G,4DAAV+B,E,QACDjH,EAAgBnP,KAAK2a,yBACvBvE,EACAF,G,uBAGM,IAAI7S,M,WAGR8X,EAAUzJ,GACZmJ,EAAQO,IAAIjM,EAAcF,QAExBoM,EAAa3J,GACfmJ,EAAQS,OAAOpK,WAAWkF,EAAOD,mBAGlBgF,GAA0B,IAAfE,E,wBAC1BH,EAAMvH,KACF,cAAO0H,EAAP,KAAqBvM,OAAO,UAAGuM,GAAazM,OAAS,I,gCAIzDsM,EAAMvH,KACF,cAAO0H,EAAP,KAAqBvM,OAAO,UAAGuM,GAAazM,OAAS,I,sBAKrD5O,KAAK+P,QAAQ7P,K,kCACPF,KAAK8Y,OAAOyC,oBACdV,EAAQO,IAAInO,YACZkC,EAAcD,kBACdmM,EACA1O,EAAWe,eACXmN,EAAQO,IAAI9N,SACZuN,EAAQO,IAAI3N,gB,QAGpBuN,I,mDAEAC,I,kJAIFO,E,UACDX,EAAQO,IAAI1H,e,QAA8BnN,EAAeoJ,UACxD8L,E,UACFZ,EAAQS,OAAO5H,e,QAAWnN,EAAeoJ,UACzC+L,EAAgB,GAChBD,IAAkBD,E,iBAClBE,EAAa,UAAM7I,GAAqB4I,I,2BAExCC,EAAa,UAAM7I,GAAqB4I,GAA3B,K,WAELzb,KAAK+P,QAAQ7P,K,kCACPF,KAAK8Y,OAAO6C,uBACdd,EAAQO,IAAInO,YACZN,EACA8O,G,QAGRT,I,mDAEAC,I,eAIFF,EACFE,EAAS,EAAI,UAAYD,EAAU,EAAI,UAAY,WACnDhb,KAAK+P,QAAQ6L,SAAWX,EAAS,KAC3BY,GACFhB,EAAQS,OAAO9H,SAAW,kCAC5B1E,OAAO,EAAG,IACZ9O,KAAKwZ,OAAOM,IAAZ,UACOiB,EADP,YACiBc,EADjB,qBACyCb,EADzC,qBAC6DC,EAD7D,oBAC+EC,EAAMY,KAC7E,KAFR,4BAGyBJ,K,kBAGtBX,G,4LAIP3E,EACAF,GAEA,IAAM6F,EAAyB7F,EAAexH,QAAO,SAACvG,GAAD,OACjDiO,EAAOF,eAAe8F,MAAK,SAACC,GAAD,OACvB1K,GAAkBpJ,EAAEgH,cAAe8M,SAI3C,OAAsC,IAAlCF,EAAuBnN,QACvB5O,KAAKwZ,OAAOM,IAAZ,iBACc1D,EAAOF,eAAe4F,KAAK,MADzC,eAGA9b,KAAKwZ,OAAOM,IAAZ,yBACsB5D,EACb9I,KAAI,SAACjF,GAAD,OAAOA,EAAEgH,iBACb2M,KAAK,QAEP,WAIenJ,IAAtByD,EAAOG,iBACe5D,IAAtByD,EAAOE,gBAGmB3D,IAAtByD,EAAOG,iBACe5D,IAAtByD,EAAOE,YACPyF,EAAuBnN,SAAWwH,EAAOE,YACzCF,EAAOG,YAAcH,EAAOE,YAE5BtW,KAAKwZ,OAAOM,IAAZ,mCACgC1D,EAAOF,eAAe4F,KAC9C,QAGR9b,KAAKwZ,OAAOM,IAAZ,uBACoB1D,EAAOG,WAD3B,YACyCH,EAAOE,WADhD,eACiEyF,EAAuBnN,SAEjF,MAEJmN,EAAuB3F,EAAOG,YAGrCwF,EAAuBnN,OAAS,GAChC5O,KAAKwZ,OAAOM,IAAZ,4CACyC1D,EAAOF,eAAe4F,KACvD,QAGR9b,KAAKwZ,OAAOM,IAAZ,yBACsBiC,EACb3O,KAAI,SAACjF,GAAD,OAAOA,EAAEgH,iBACb2M,KAAK,QAEP,MAGJC,EAAuB,K,qGAI9BlP,EACAF,EACA+J,G,uFAEMkE,EAA0C,G,eAE1B/N,G,gEAAXgO,E,iBACc7a,KAAKkc,wBACtBrB,EACAlO,EACA+J,G,OAHEqE,E,YAKyBpI,IAA3BiI,EAAeG,KACfH,EAAeG,GAAU,GAE7BH,EAAeG,K,+IAInB,IADMoB,EAAajP,OAAOC,KAAKyN,IAChBhM,OAAS,EAAG,CACvB5O,KAAKwZ,OAAOM,IAAI,6BADO,eAEPqC,GAFO,IAEvB,2BAAW9O,EAAiB,QACxBrN,KAAKwZ,OAAOM,IAAZ,YAAqBzM,EAArB,cAA4BuN,EAAevN,KAHxB,oCAMvBrN,KAAKwZ,OAAOM,IAAI,oC,kNAKpBe,EACAlO,EACA+J,G,kFAEIqE,EAAS,GACPS,EAAmBX,EAAQnH,QAC1BmH,EAAQnH,QACTnN,EAAeoJ,WACf8L,EAAgB/E,KACA8E,E,gBAClBT,EAAS,U,oCAGD/a,KAAK+P,QAAQ7P,K,kCACPF,KAAK8Y,OAAO6C,uBACdd,EAAQ5N,YACRN,EACA8O,G,QAGRV,EAAS,U,kDAETA,EAAS,S,eAIb/a,KAAK+P,QAAQ6L,SAAsB,WAAXb,KAClBc,GACFhB,EAAQuB,WAAa,kCACvBtN,OAAO,EAAG,IACNuN,EACS,YAAXtB,EAAA,UACSlI,GACL4I,GAFJ,iBAGc5I,GAAqB2I,IAC7B3I,GAAqB4I,GAC/Bzb,KAAKwZ,OAAOM,IAAZ,UAAmBiB,EAAnB,YAA6Bc,EAA7B,YAA4CQ,K,kBAEzCtB,G,yJAGGjG,EAAiCoF,GAC3C,IADuE,EACjEoC,EAAoBpC,EAAYxL,OAAO6N,IAEvCnC,EAAkC,GAClCC,EAAyC,GAJwB,eAK3CvF,GAL2C,yBAK5D0H,EAL4D,QAM7DC,EAAmBH,EAAkB5N,QAAO,SAACgO,GAAD,OAuD9D,SACIA,EACAF,GAEA,IAAMG,EAAcrD,GAAUoD,EAAWN,YACnCQ,EAAiBtD,GAAUkD,EAAchJ,UAC/C,OAAOmJ,EAAYhO,WAAWiO,GA5DlBC,CAAgBH,EAAYF,MAEA,IAA5BC,EAAiB7N,OACjBwL,EAAezG,KAAK,CAChB2H,OAAQkB,EACRpB,IAAKqB,EAAiB,KAG1BpC,EAAsB1G,KAAK6I,IAVnC,2BAA6C,IAL0B,8BAmBvE,IAnBuE,EAmBjElC,EAAoC,GAnB6B,eAoB9CgC,GApB8C,yBAoB5DI,EApB4D,QAsB9DtC,EAAe4B,MACZ,SAACc,GAAD,OAAQA,EAAG1B,IAAInO,cAAgByP,EAAWzP,gBAG9CqN,EAAmB3G,KAAK+I,IANhC,2BAA6C,IApB0B,8BA8BvE,MAAO,CAACtC,iBAAgBC,wBAAuBC,wB,wCAI/CF,EACAC,EACAC,GAEAta,KAAKwZ,OAAOM,IAAZ,4BAAqCM,EAAexL,SACpD5O,KAAKwZ,OAAOM,IAAZ,wCACqCO,EAAsBzL,SAH7D,qBAKkByL,GALlB,IAKE,2BAAuC,CAAC,IAA7BtN,EAA4B,QACnC/M,KAAKwZ,OAAOM,IAAI,KAAO/M,EAAEyG,WAN/B,8BAQExT,KAAKwZ,OAAOM,IAAZ,qCACkCQ,EAAmB1L,SATvD,qBAWkB0L,GAXlB,IAWE,2BAAoC,CAAC,IAA1BvN,EAAyB,QAChC/M,KAAKwZ,OAAOM,IAAI,KAAO/M,EAAEqP,aAZ/B,mC,KAiBN,SAASG,GAAgBG,GACrB,MACiC,2DAA7BA,EAAWK,eACkB,qDAA7BL,EAAWK,cCnbZ,IAAMC,GAAb,iDACYC,iBADZ,OAEYC,mBAFZ,4DAIkBC,GACLnd,KAAKid,cACNjd,KAAKid,YAAc,IACvBjd,KAAKid,YAAYtJ,KAAKwJ,KAP9B,uCAUqBA,GACRnd,KAAKid,cAEVjd,KAAKid,YAAcjd,KAAKid,YAAYvO,QAAO,SAAA0O,GAAC,OAAIA,IAAMD,QAb9D,sCAgBoBE,GACPrd,KAAKkd,gBACNld,KAAKkd,cAAgB,IACzBld,KAAKkd,cAAcvJ,KAAK0J,KAnBhC,yCAsBuBA,GACVrd,KAAKkd,gBAEVld,KAAKkd,cAAgBld,KAAKkd,cAAcxO,QAAO,SAAA0O,GAAC,OAAIA,IAAMC,QAzBlE,0BA4BQzb,GACA,GAAK5B,KAAKid,YAAV,CADiB,qBAGQjd,KAAKid,aAHb,IAGjB,6BACIE,EADJ,SACevb,IAJE,kCA5BzB,4BAmCU0b,GACF,GAAKtd,KAAKkd,cAAV,CADwB,qBAGGld,KAAKkd,eAHR,IAGxB,6BACIG,EADJ,SACiBC,IAJO,oCAnChC,K,gDCYMC,I,OAAgBC,cAAW,iBAAO,CACpCC,KAAM,CACFC,QAAS,MAFKF,CAIlBG,OAEEC,GAAgBJ,cAAW,iBAAO,CACpCC,KAAM,CACFI,QAAS,OACTC,eAAgB,mBAHFN,CAKlBO,MAEiBC,G,kDAGjB,WAAY5Z,GAAe,IAAD,8BACtB,cAAMA,IAHV6Z,kBAE0B,IAqB1BC,WAAa,SAACtc,GACV,EAAK0H,SAAS,CAAC6U,SAAS,GAAD,oBAAM,EAAK1T,MAAM0T,UAAjB,CAA2Bvc,OAtB5B,EAyB1ByI,UAzB0B,sBAyBd,gCAAAlC,EAAA,6DACR,EAAK8V,aAAaG,YAAYC,cAAc,EAAKH,YADzC,EAGuC,EAAK9Z,MAAMka,UAAnD5E,EAHC,EAGDA,gBAAiBC,EAHhB,EAGgBA,oBAHhB,SAIF,EAAKsE,aAAaM,mBAAmB7E,EAAiBC,GAJpD,OAMR,EAAKsE,aAAaG,YAAYI,iBAAiB,EAAKN,YAEpD,EAAK5U,SAAS,CACVmQ,eAAe,EACfgF,WAAW,IAVP,2CAzBc,EAuC1BC,WAAa,WACT,EAAKpV,SAAS,CAACmQ,eAAe,IAC9B,EAAKwE,aAAaU,UAtClB,EAAKV,aAAe7Z,EAAM6Z,aAE1B,EAAKxT,MAAQ,CACTgU,WAAW,EACXhF,eAAe,EACf0E,SAAU,IARQ,E,gEActBne,KAAKqK,c,6CAILrK,KAAK0e,e,+BA2BL,OACI,cAAC,IAAMja,SAAP,UACI,eAACma,GAAA,EAAD,CAAQtZ,KAAMtF,KAAKoE,MAAMya,QAAS7T,SAAS,KAAKpG,WAAS,EAACuB,UAAU,gBAApE,UACI,cAAC,KAAD,kFACA,cAAC,GAAD,CAAe2Y,UAAQ,EAAvB,SACI,cAACxH,GAAA,EAAD,CAAMyH,OAAK,EAACnG,gBAAc,EAACoG,MAAO,CAACC,UAAW,KAA9C,SACKjf,KAAKyK,MAAM0T,SAAS/Q,KAAI,SAAChC,EAAM6K,GAAP,OACrB,cAACyB,GAAA,EAAD,CAAsBsH,MAAO,CAACE,WAAY,EAAGC,cAAe,GAA5D,SACI,cAACxH,GAAA,EAAD,CAAcC,QAASxM,EAAM4T,MAAO,CAACI,UAAW,EAAGC,aAAc,MADtDpJ,UAM3B,eAAC,GAAD,WACI,cAACjQ,EAAD,CAAmBE,QAASlG,KAAKyK,MAAMgU,UACpB3Z,QAAS9E,KAAKoE,MAAMkb,SACpBrZ,MAAM,iBACzB,cAACD,EAAD,CAAmBE,QAASlG,KAAKyK,MAAMgP,cACpBrT,UAAWpG,KAAKyK,MAAMgU,UACtB3Z,QAAS9E,KAAK0e,WACdzY,MAAM,qD,GApEPU,IAAM8E,WCR1C8T,G,kDAIF,WAAYnb,GAAe,IAAD,8BACtB,cAAMA,IAJVka,UAAuB,GAGG,EAF1BL,aAA6B,GAEH,EAgB1BuB,sBAAwB,SAACC,GACrB,IAAMhY,EAASgY,EAAMhY,OACrB,OAAQA,EAAOtH,MACX,IAAK,YACG,EAAKsK,MAAMiV,cAAcnX,OACzB,EAAKe,SAAS,CAACoW,cAAe,CAACnX,OAAO,EAAO3G,QAAS,MAC1D,EAAK0H,SAAS,CAACqW,SAAUlY,EAAOF,UAtBlB,EA0B1BqY,gBA1B0B,uCA0BR,WAAO5Y,GAAP,mBAAAmB,EAAA,6DACb,OAADnB,QAAC,IAADA,KAAGC,iBACH,EAAKqC,SAAS,CAACpD,SAAS,IAFV,SAIgB,EAAK2Z,gCAJrB,UAIRnG,EAJQ,wEAQqB,EAAKoG,6BAA6BpG,EAAgBnF,kBARvE,UAQRwL,EARQ,0DAYRC,EAAkB,EAAKC,uBAAuBF,EAAsBrG,GAE1E,EAAK4E,UAAU5E,gBAAkBA,EACjC,EAAK4E,UAAU3E,oBAAsBoG,EAErC,EAAKzW,SAAS,CACVpD,SAAS,EACTuG,YAAauT,EAAgBvT,YAC7ByT,iBAAiB,EACjBC,kBAAmBH,EAAgBI,OACnCC,mBAAoBL,EAAgBI,SAtB1B,4CA1BQ,wDAsI1BE,wBAA0B,SAACb,GAA4D,IAAD,EAClFA,EAAMxY,iBACN,EAAKqC,SAAS,CAAC+W,mBAAmB,IAElC,IAAM9d,EC/JC,SAA0Bge,EAAiBC,GACtD,IACI,OAAOD,IACT,MAAOvZ,GAEL,OADAwZ,EAAQxZ,GACD,MD0JOyZ,EAAc,kBAAM,EAAKrc,MAAM0U,OAAOhP,QAAQvH,QAAO,EAAK6B,MAAMoc,SAC9E,GAAKje,EAAL,CAGA,IAAMgS,EAAgB,UAAG,EAAK+J,UAAU5E,uBAAlB,aAAG,EAAgCnF,iBACzD,GAAKA,EAILnS,EzB9GD,SAAwBG,EAAeM,EAAgB0R,GAAqC,IACxF1I,EAAoC0I,EAApC1I,KAAMC,EAA8ByI,EAA9BzI,SAAUC,EAAoBwI,EAApBxI,OAAQC,EAAYuI,EAAZvI,SAC/B,MAAM,GAAN,OAAUzJ,EAAV,YAAmBM,EAAnB,YAA6BgJ,EAA7B,YAAqCC,EAArC,YAAiDC,EAAjD,YAA2DC,GyB2GrC5J,CAAqBG,EAAO,gBAAiBgS,GACxC3U,EAAYa,OAEnC,EAAKmf,oBArJiB,EAwJ1Bf,QAAU,SAAC3e,GACP,IAAMsZ,EAAS,IAAIwD,GACnBxD,EAAOkH,gBAAgB,EAAKtc,MAAMoc,SAElC,IAAMzQ,EAA2B,CAAC7P,OAAM0b,SAAS,GAEjD,EAAKqC,aAAe,IAAI1E,GAAa,EAAKnV,MAAM0U,OAAQU,EAAQzJ,GAEhE,EAAKzG,SAAS,CAACqX,WAAW,KAhKJ,EAmK1BC,kBAAoB,kBAAM,EAAK/B,SAAQ,IAnKb,EAqK1BgC,oBAAsB,kBAAM,EAAKhC,SAAQ,IArKf,EAuK1BiC,mBAAqB,kBAAM,EAAKxX,SAAS,CAACqX,WAAW,KApKjD,EAAKlW,MAAQ,CACTkV,SAAU,GACVzZ,SAAS,EACTga,iBAAiB,EACjBR,cAAe,CAACnX,OAAO,EAAO3G,QAAS,IACvC6K,YAAa,GACb0T,mBAAmB,EACnBE,mBAAmB,EACnBM,WAAW,GAXO,E,mEAoDHZ,EAAoCrG,GAGvD,IAAMqH,EAAe,IAAIC,IAAItH,EAAgB5E,eAAe1H,KAAI,SAAAL,GAAC,OAAIA,EAAE0G,cACjEwN,EAAkB,IAAID,IAAIjB,EAAqB3S,KAAI,SAAAL,GAAC,OAAIA,EAAE8M,UAE5DqH,EAAc,EACZnJ,EAA6BoJ,MAAMC,KAAKL,GACzC3T,KAAI,SAAAyM,GACD,IAAMwH,GAAeJ,EAAgBK,IAAIzH,GAGzC,OAFIwH,GACAH,IACG,CAACjb,MAAO4T,EAAOtB,QAAS8I,MAGvC,MAAO,CACHjB,OAAQc,GAAeH,EAAaza,KACpCmG,YAAa,CAAC,CACVxG,MAAOyT,EAAgBnF,iBAAiBpU,KACxC4X,mB,4FAKuBxD,G,qGACxBsE,GAA4B7Y,KAAKoE,MAAM0U,OAAQvE,GACjDzQ,MAAK,SAAAC,GAAC,OAAIA,KAAG,SAAAwE,GACV,EAAKe,SAAS,CAACpD,SAAS,IACxB,EAAK9B,MAAMoc,QAAQjY,O,+RAKGvI,KAAKuhB,0B,UAA7BC,E,8BAEFxhB,KAAKsJ,SAAS,CAACpD,SAAS,I,kBACjB,M,gCAKiB0N,GAAwB4N,EAAgBtR,cAAesR,EAAgB3N,W,OAA/F6F,E,gEAEA1Z,KAAKsJ,SAAS,CAACpD,SAAS,IACxBlG,KAAKoE,MAAMoc,QAAQ,KAAE5e,SAAWrB,KAAKC,UAAL,O,kBACzB,M,iCAGJkZ,G,+RAID+H,E,YAAS,+C,8BAGX,QAFEle,EAASvD,KAAKyK,MAAMkV,SAASzc,MAAMue,UAErC,IAACle,OAAD,EAACA,EAAQme,SAAWne,EAAOme,OAAOxR,c,uBAClClQ,KAAKsJ,SAAS,CACVpD,SAAS,EACTwZ,cAAe,CAACnX,OAAO,EAAM3G,QAAS,0F,kBAEnC,M,cAELsO,EAAgB3M,EAAOme,OAAOxR,cAC9ByR,EAAepe,EAAOme,OAAOE,SAAW,K,mBAGN7Q,GAAyBb,G,WAAvD2R,E,OACAC,EAAaH,EACbE,EAAsBnT,QAAO,SAAA3B,GAAC,OAAIA,EAAE6U,QAAQnS,aAAekS,KAAc,GACzEE,EAAsB,G,wBAExB7hB,KAAKoE,MAAMoc,QAAQ,sB,kBACZ,M,eAEL3M,EAAYiO,EAAW7b,M,kBACtB,CAACiK,gBAAe2D,c,yCAEvB7T,KAAKoE,MAAMoc,QAAQ,KAAE5e,SAAWrB,KAAKC,UAAL,O,kBACzB,M,+IAwCX,OACI,uBAAM2F,UAAW,oBAAjB,UACI,oBAAIA,UAAW,sBAAf,mPACA,uBAAMM,SAAUzG,KAAK4f,gBAAiBzZ,UAAW,sBAAjD,UACI,cAACe,EAAA,EAAD,CAAW/G,KAAK,YACLkH,MAAM,uCACN1C,KAAK,OACLwB,UAAW,WACXoB,MAAOvH,KAAKyK,MAAMkV,SAClBnY,SAAUxH,KAAKwf,sBACfjX,MAAOvI,KAAKyK,MAAMiV,cAAcnX,MAChCwZ,WAAY/hB,KAAKyK,MAAMiV,cAAc9d,QACrCogB,UAAQ,IACnB,cAAChc,EAAD,CAAmBC,MAAM,yDACNC,QAASlG,KAAKyK,MAAMvE,QACpBC,UAAW,cAElC,eAACqS,GAAA,EAAD,CAAUC,GAAIzY,KAAKyK,MAAMyV,gBAAiB/Z,UAAW,sBAArD,UACI,gOACA,4OAA8C,mBAAGA,UAAW,eAAd,8EAC9C,cAAC6Q,GAAD,CAAYC,MAAOjX,KAAKyK,MAAMgC,YAAayK,WAAW,IACrDlX,KAAKyK,MAAM0V,kBACR,eAAC,IAAM1b,SAAP,WACI,mUACA,qBAAI0B,UAAW,YAAf,UACI,mVACA,6LACA,6BAAI,mBAAGA,UAAW,cACXrB,QAAS9E,KAAKsgB,wBADjB,wHAIZ,eAAC,IAAM7b,SAAP,WACI,2VAAmE,mBAC/D0B,UAAW,cACX8b,iBAAe,EACfnd,QAAS9E,KAAKsgB,wBAHiD,mHAKnE,cAAC4B,GAAD,CAAkBhJ,QAASlZ,KAAKyK,MAAM4V,kBACpBlH,cAAenZ,KAAK4gB,kBACpBxH,gBAAiBpZ,KAAK6gB,4BAInD7gB,KAAKyK,MAAMkW,WACZ,cAAC,GAAD,CAAcrC,UAAWte,KAAKse,UAChBgB,SAAUtf,KAAK8gB,mBACfjC,QAAS7e,KAAKyK,MAAMkW,UACpB1C,aAAcje,KAAKie,sB,GA7NlBtX,IAAM8E,WAoOtB0W,kBAAK5C,I,oBE/Od6C,GAAazb,IAAM0b,YAAW,SAChCje,EACAke,GAEA,OAAO,cAACC,GAAA,EAAD,aAAOC,UAAU,KAAKF,IAAKA,GAASle,OAGhC,SAASqe,GAAT,GAAmE,IAArCnd,EAAoC,EAApCA,KAAMod,EAA8B,EAA9BA,YAA8B,KAAjB5Y,QAC5BnD,IAAMC,UAAS,IAD8B,mBACtE0D,EADsE,KAC5DqY,EAD4D,KAO7E,OACI,eAAC,IAAMle,SAAP,WACK6F,GAAY,cAAC,IAAD,CAAUO,GAAG,MAC1B,eAAC+T,GAAA,EAAD,CACItZ,KAAMA,EACNsd,oBAAqBR,GACrBS,aAAW,EACXtL,kBAAgB,2BAChBuL,mBAAiB,iCALrB,UAMI,cAACC,GAAA,EAAD,CAAa3b,GAAG,2BAAhB,+JACA,cAACmW,GAAA,EAAD,UACI,eAACyF,GAAA,EAAD,CAAmB5b,GAAG,iCAAtB,+IAC8Bsb,EAD9B,wPAIJ,cAAC9E,GAAA,EAAD,CAAeoB,MAAO,CAACnB,QAAS,OAAQC,eAAgB,gBAAxD,SACI,cAACpZ,EAAA,EAAD,CAAQI,QApBP,WACb6d,GAAY,IAmB2B5d,MAAM,UAAjC,kC,WChCL,cACX,OACI,qBAAKoB,UAAW,eAAhB,SACI,cAACE,EAAA,EAAD,CAAkBC,KAAM,IAAKH,UAAW,gBCK/B8c,G,kDACjB,WAAY7e,GAAe,IAAD,8BACtB,cAAMA,IA6BV8e,qBAAuB,SAACR,GACpB,EAAKpZ,SAAS,CAAC6Z,yBAAyB,EAAMT,cAAaxc,SAAS,KA/B9C,EAkC1Bkd,YAAc,SAAC7a,GACX,IAAM+U,EAAuB/U,EAAM3G,SAAWrB,KAAKC,UAAU+H,GACzDA,EAAM5G,WACF4G,EAAM5G,aAAeF,EAAWuC,gBAChC,EAAKkf,qBAAqB,sBAE1B,EAAKA,qBAAqB,UACV,iBAAf3a,EAAMpI,KACX,EAAKmJ,SAAS,CAACgU,aAAc,qRAE7B,EAAKhU,SAAS,CAACgU,kBA5CG,EA+C1B+F,WAAa,WACT,EAAK/Z,SAAS,CAACgU,aAAc,MAhDP,EAmD1BgG,kBAAoB,WAChB,EAAKha,SAAS,CAACgB,UAAU,KAjDzB,EAAKG,MAAQ,CACT8Y,cAAc,EACd1E,SAAS,EACTsE,yBAAyB,EACzBT,YAAa,GACbpF,aAAc,GACdpX,SAAS,EACToE,UAAU,GAVQ,E,kMAgBhB1C,EAAWC,O,uBACX7H,KAAKoE,MAAM0F,QAAQa,kB,OAEnBd,EAAgB7J,KAAKoE,MAAM0F,QAAQc,YACnCT,EAAmBvC,EAAWY,kBAE/BqB,EAEKM,EAGNnK,KAAKsJ,SAAS,CAACpD,SAAS,IAFxBlG,KAAKkjB,qBAAqB,UAF1BljB,KAAKkjB,qBAAqB,sB,qIAiC9B,OACI,eAAC,IAAMze,SAAP,WACKzE,KAAKyK,MAAMvE,SAAW,cAACsd,GAAD,IACtBxjB,KAAKyK,MAAM0Y,yBAA2B,cAACV,GAAD,CAAqB3Y,QAAS9J,KAAKoE,MAAM0F,QACpB4Y,YAAa1iB,KAAKyK,MAAMiY,YACxBpd,KAAMtF,KAAKyK,MAAM0Y,0BAC5EnjB,KAAKyK,MAAM6S,cAAgB,cAACjY,EAAD,CAAaC,OAAQtF,KAAKyK,MAAM6S,aACnB1b,QAAS5B,KAAKyK,MAAM6S,aACpB3Y,KAAM,QACNY,QAASvF,KAAKqjB,aACtDrjB,KAAKyK,MAAMH,UAAY,cAAC,IAAD,CAAUO,GAAG,MACrC,qBAAK1E,UAAU,YAAf,SACI,eAAC2E,EAAA,EAAD,CAAWE,SAAS,KAApB,UACI,cAACtG,EAAA,EAAD,CAAQG,QAAQ,YACRma,MAAO,CAACI,UAAW,IACnBta,QAAS9E,KAAKsjB,kBAFtB,iKAKA,cAAC,GAAD,CAAkBxK,OAAQ9Y,KAAKoE,MAAM0U,OAAQ0H,QAASxgB,KAAKojB,0B,GA3E7Czc,IAAM8E,WCR7B,cACX,OACI,cAAC,EAAQC,SAAT,UAEQ,SAAAC,GAAO,OAAI,cAAC,GAAD,CAAU7B,QAAS6B,EAAQ7B,QAASgP,OAAQnN,EAAQmN,aCCzE2K,GAAc,IAAI3jB,GAAe,GACjCgK,GAAU,IAAIhI,EAAQ2hB,IACtB3K,GAAS,IAAIlN,GAAO9B,GAAS2Z,IAEpB,SAASC,KACpB,OACI,cAAC,EAAQC,SAAT,CAAkBpc,MAAO,CAACuC,WAASgP,WAAnC,SACI,cAAC,IAAD,CAAY8K,SAAU,UAAtB,SACI,eAAC,IAAD,WACI,cAAC,IAAD,CAAOC,KAAK,QAAQ9Y,UAAW+Y,KAC/B,cAAC,IAAD,CAAOC,OAAK,EAACF,KAAK,GAAG9Y,UAAWiZ,WCjBpD,IAYeC,GAZS,SAACC,GACjBA,GAAeA,aAAuBC,UACtC,8BAAqBrgB,MAAK,YAAgD,IAA9CsgB,EAA6C,EAA7CA,OAAQC,EAAqC,EAArCA,OAAQC,EAA6B,EAA7BA,OAAQC,EAAqB,EAArBA,OAAQC,EAAa,EAAbA,QACxDJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,O,OCFpBO,IAASC,OACL,cAAChB,GAAD,IACAiB,SAASC,eAAe,SAM5BX,O","file":"static/js/main.4fae1781.chunk.js","sourcesContent":["import {DisciplineConfig} from \"../functions/getSpreadsheetDataAsync\";\r\n\r\nconst memoryCache: { [name: string]: object | string } = {};\r\n\r\nexport function save(name: string, data: object | string, whereTo: StorageType) {\r\n    if (!data) {\r\n        return false;\r\n    }\r\n\r\n    const json = JSON.stringify(data);\r\n\r\n    if (whereTo === StorageType.Local || whereTo === StorageType.LocalAndSession)\r\n        localStorage.setItem(name, json);\r\n    if (whereTo === StorageType.Session || whereTo === StorageType.LocalAndSession)\r\n        sessionStorage.setItem(name, json);\r\n\r\n    memoryCache[name] = data;\r\n\r\n    return true;\r\n}\r\n\r\nexport function read<T extends object | string>(name: string, whereFrom: StorageType) {\r\n    const localData = memoryCache[name];\r\n    if (localData && whereFrom !== StorageType.Session) {\r\n        return localData as T;\r\n    }\r\n\r\n    let content: string | null = null\r\n\r\n    if (whereFrom === StorageType.Local || whereFrom === StorageType.LocalAndSession)\r\n        content = localStorage.getItem(name);\r\n    if (whereFrom === StorageType.Session || whereFrom === StorageType.LocalAndSession)\r\n        content = sessionStorage.getItem(name);\r\n\r\n    if (!content) {\r\n        return null;\r\n    }\r\n\r\n    const memoryData = JSON.parse(content);\r\n    if (!memoryData) {\r\n        return null;\r\n    }\r\n\r\n    memoryCache[name] = memoryData;\r\n    return memoryData as T;\r\n}\r\n\r\nexport function clear(name: string, storageType: StorageType) {\r\n    if (storageType === StorageType.Local || storageType === StorageType.LocalAndSession)\r\n        localStorage.removeItem(name);\r\n    if (storageType === StorageType.Session || storageType === StorageType.LocalAndSession)\r\n        sessionStorage.removeItem(name);\r\n\r\n    delete memoryCache[name];\r\n\r\n    return true;\r\n}\r\n\r\nexport function buildCacheName(login: string, method: string, disciplineConfig: DisciplineConfig) {\r\n    const {year, termType, course, isModule} = disciplineConfig;\r\n    return `${login}_${method}_${year}_${termType}_${course}_${isModule}`;\r\n}\r\n\r\nexport enum StorageType {\r\n    Local,\r\n    Session,\r\n    LocalAndSession\r\n}\r\n","const brsUrl = 'https://brs.urfu.ru/mrd';\r\nconst corsProxy = 'https://kamikoto-cors-proxy.herokuapp.com';\r\n\r\nexport default class BrsUrlProvider {\r\n    private readonly withProxy: boolean;\r\n\r\n    constructor(withProxy: boolean) {\r\n        this.withProxy = withProxy;\r\n    }\r\n\r\n    get baseUrl() {\r\n        return this.withProxy ? `${corsProxy}/${brsUrl}` : brsUrl;\r\n    }\r\n}\r\n","export class CustomError {\r\n    readonly message: string;\r\n    readonly statusCode: StatusCode;\r\n\r\n    constructor(statusCode: StatusCode, message: string = '') {\r\n        this.statusCode = statusCode;\r\n        this.message = message;\r\n    }\r\n}\r\n\r\nexport enum StatusCode {\r\n    BrsUnauthorized = 1,\r\n    GoogleUnauthorized\r\n}\r\n","import request from \"request-promise\";\r\nimport BrsUrlProvider from \"./brsUrlProvider\";\r\nimport * as cache from \"../helpers/cache\";\r\nimport {StorageType} from \"../helpers/cache\";\r\nimport {CustomError, StatusCode} from \"../helpers/CustomError\";\r\n\r\nexport default class BrsAuth {\r\n    readonly brsUrlProvider: BrsUrlProvider;\r\n\r\n    constructor(brsUrlProvider: BrsUrlProvider) {\r\n        this.brsUrlProvider = brsUrlProvider;\r\n    }\r\n\r\n    private _sid: string | null = null;\r\n\r\n    get sid() {\r\n        if (!this._sid)\r\n            throw new CustomError(StatusCode.BrsUnauthorized, 'BRS unauthorized');\r\n        return this._sid;\r\n    }\r\n\r\n    private _login: string | null = null;\r\n\r\n    get login() {\r\n        if (!this._login)\r\n            throw new CustomError(StatusCode.BrsUnauthorized, 'BRS unauthorized');\r\n        return this._login;\r\n    }\r\n\r\n    private _username?: string = \"Anonymous\";\r\n\r\n    get username() {\r\n        return this._username;\r\n    }\r\n\r\n    checkAuth() {\r\n        return !!(this._sid && this._login);\r\n    }\r\n\r\n    async tryRestoreAsync() {\r\n        if (!!(this._sid && this._login))\r\n            return;\r\n\r\n        let loginInfo = cache.read<LoginInfo>(\"loginInfo\", StorageType.Session);\r\n        if (loginInfo) {\r\n            this.saveLoginInfo(loginInfo.sid, loginInfo.login, loginInfo.username);\r\n            return;\r\n        }\r\n\r\n        loginInfo = cache.read<LoginInfo>(\"loginInfo\", StorageType.Local);\r\n        if (!loginInfo)\r\n            return;\r\n\r\n        const sidCheckResult = await this.checkSidAsync(loginInfo.sid);\r\n        if (sidCheckResult?.success)\r\n            this.saveLoginInfo(loginInfo.sid, loginInfo.login, loginInfo.username);\r\n    }\r\n\r\n    private async checkSidAsync(sid: string): Promise<SidCheckResult | null> {\r\n        try {\r\n            const response: string = await request({\r\n                method: 'GET',\r\n                url: this.brsUrlProvider.baseUrl + \"/mvc/mobile\",\r\n                headers: {\r\n                    'X-Cookie': `JSESSIONID=${sid}`,\r\n                    'X-Requested-With': 'XMLHttpRequest',\r\n                },\r\n            });\r\n\r\n            const username = response.match(/username\">([А-ЯЁа-яё \\-]+)</);\r\n            if (username)\r\n                return {success: true, username: username[1]};\r\n            return {success: false, username: \"Anonymous\"}\r\n\r\n        } catch (e) {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    async loginAsync(login: string, password: string): Promise<LoginStatus> {\r\n        const response = await this.requestSidAsync(login, password);\r\n\r\n        if (!response || !('x-set-cookie' in response.headers)) {\r\n            return LoginStatus.Error;\r\n        }\r\n\r\n        const cookie = response.headers['x-set-cookie'] as string;\r\n        const result = cookie.match(/(?<=JSESSIONID=)\\w+/);\r\n\r\n        if (!result)\r\n            return LoginStatus.Error;\r\n\r\n        const sid = result[0];\r\n\r\n        const checkResult = await this.checkSidAsync(sid);\r\n        if (checkResult === null)\r\n            return LoginStatus.Error;\r\n        if (!checkResult.success)\r\n            return LoginStatus.InvalidCredentials;\r\n\r\n        this.saveLoginInfo(sid, login, checkResult.username);\r\n\r\n        return LoginStatus.Succeed;\r\n    }\r\n\r\n    async authBySidAsync(sid: string): Promise<LoginStatus> {\r\n        if (!sid)\r\n            return LoginStatus.InvalidCredentials;\r\n\r\n        const checkResult = await this.checkSidAsync(sid);\r\n        if (checkResult === null)\r\n            return LoginStatus.Error;\r\n        if (!checkResult.success)\r\n            return LoginStatus.InvalidCredentials;\r\n\r\n        this.saveLoginInfo(sid, \"Anonymous\", checkResult.username);\r\n\r\n        return LoginStatus.Succeed;\r\n    }\r\n\r\n    private saveLoginInfo(sid: string, login: string, username: string) {\r\n        cache.save(\"loginInfo\", {sid, login, username}, StorageType.LocalAndSession);\r\n        this._sid = sid;\r\n        this._login = login;\r\n        this._username = username;\r\n    }\r\n\r\n    logout() {\r\n        this._sid = null;\r\n        this._login = null;\r\n        cache.clear(\"loginInfo\", StorageType.LocalAndSession);\r\n    }\r\n\r\n    private async requestSidAsync(login: string, password: string) {\r\n        return await request({\r\n            url: this.brsUrlProvider.baseUrl + `/login`,\r\n            method: 'POST',\r\n            body: `username=${login}&password=${password}`,\r\n            resolveWithFullResponse: true,\r\n            simple: false,\r\n            headers: {\r\n                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\r\n            },\r\n        }).then(x => x, () => null);\r\n    }\r\n}\r\n\r\nexport enum LoginStatus {\r\n    Succeed,\r\n    InvalidCredentials,\r\n    Error\r\n}\r\n\r\ninterface LoginInfo {\r\n    sid: string;\r\n    login: string;\r\n    username: string;\r\n}\r\n\r\ninterface SidCheckResult {\r\n    success: boolean;\r\n    username: string;\r\n}\r\n","import {createContext} from \"react\";\r\nimport BrsAuth from \"./apis/brsAuth\";\r\nimport BrsApi from \"./apis/brsApi\";\r\n\r\n// @ts-ignore\r\nconst Context = createContext<{ brsAuth: BrsAuth, brsApi: BrsApi }>();\r\n\r\nexport default Context;\r\n","import GoogleLogin from \"react-google-login\";\r\nimport React from \"react\";\r\nimport {Button} from \"@material-ui/core\";\r\n\r\nconst CLIENT_ID = '122993083593-pacve8csj86voko30ia65raeg0ncrtuv.apps.googleusercontent.com';\r\nconst SCOPES = \"profile email https://www.googleapis.com/auth/spreadsheets\";\r\n\r\nexport default function GoogleLoginButton(props: Props) {\r\n    const {onSignedIn, onFailure, signedIn, username, onLogout} = props;\r\n    \r\n    return (\r\n        <React.Fragment>\r\n            {\r\n                signedIn ?\r\n                    <React.Fragment>\r\n                        <p>Добро пожаловать, {username}</p>\r\n                        <Button type=\"button\"\r\n                                fullWidth\r\n                                variant=\"contained\"\r\n                                onClick={onLogout}\r\n                                color=\"primary\">\r\n                            Выйти из Google\r\n                        </Button>\r\n                    </React.Fragment> :\r\n                    <GoogleLogin\r\n                        clientId={CLIENT_ID}\r\n                        buttonText=\"Войти в аккаунт Google\"\r\n                        onSuccess={onSignedIn}\r\n                        onFailure={onFailure}\r\n                        scope={SCOPES}\r\n                        isSignedIn={true}/>\r\n            }\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\ninterface Props {\r\n    onSignedIn: () => void;\r\n    onFailure: (error: any) => void;\r\n    onLogout: () => void;\r\n    signedIn: boolean;\r\n    username?: string;\r\n}\r\n","import React from \"react\";\r\nimport MuiAlert, {AlertProps} from '@material-ui/lab/Alert';\r\nimport {Snackbar} from \"@material-ui/core\";\r\n\r\nexport default function CustomAlert(props: Props) {\r\n    const {open, message, type, onClose} = props;\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <Snackbar\r\n                open={open}\r\n                autoHideDuration={10000}\r\n                anchorOrigin={{vertical: 'top', horizontal: 'center'}}\r\n                onClose={onClose}>\r\n                <Alert severity={type} onClose={onClose}>\r\n                    {message}\r\n                </Alert>\r\n            </Snackbar>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nfunction Alert(props: AlertProps) {\r\n    return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\ninterface Props {\r\n    open: boolean;\r\n    message: string;\r\n    type: \"error\" | \"success\";\r\n    onClose: () => void;\r\n}\r\n","import {Button, CircularProgress} from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport \"./styles.css\";\r\n\r\nexport default function SubmitWithLoading(props: Props) {\r\n    const {title, loading, className, onClick, disabled = false} = props;\r\n\r\n    return (\r\n        <div className={\"submit-with-loading \" + className}>\r\n            <Button type=\"submit\"\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    onClick={onClick}\r\n                    disabled={loading || disabled}>\r\n                {title}\r\n            </Button>\r\n            {\r\n                loading &&\r\n                <CircularProgress color=\"secondary\" size={24} className=\"button-progress\"/>\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    title: string;\r\n    loading: boolean;\r\n    className?: string;\r\n    onClick?: () => void;\r\n    disabled?: boolean;\r\n}\r\n","import 'bluebird';\r\nimport request from 'request-promise';\r\nimport * as cache from '../helpers/cache';\r\nimport {StorageType} from '../helpers/cache';\r\nimport BrsAuth from \"./brsAuth\";\r\nimport BrsUrlProvider from \"./brsUrlProvider\";\r\nimport {CustomError, StatusCode} from \"../helpers/CustomError\";\r\n\r\nexport default class BrsApi {\r\n    readonly brsAuth: BrsAuth;\r\n    private readonly brsUrlProvider: BrsUrlProvider;\r\n\r\n    constructor(brsAuth: BrsAuth, brsUrlProvider: BrsUrlProvider) {\r\n        this.brsAuth = brsAuth;\r\n        this.brsUrlProvider = brsUrlProvider;\r\n    }\r\n\r\n    async getDisciplineCachedAsync(\r\n        year: number,\r\n        termType: TermType,\r\n        course: number,\r\n        isModule: boolean\r\n    ) {\r\n        const cacheName = `${this.brsAuth.login}_getDiscipline_${year}_${termType}_${course}_${isModule}`;\r\n        const cacheResult = cache.read<Discipline[]>(cacheName, StorageType.Local);\r\n        if (cacheResult) {\r\n            return cacheResult;\r\n        }\r\n\r\n        const total = await this.getDisciplineTotalAsync(year, termType, course, isModule);\r\n        const result = await this.getDisciplineInternalAsync(\r\n            year,\r\n            termType,\r\n            course,\r\n            isModule,\r\n            total\r\n        );\r\n        cache.save(cacheName, result, StorageType.Local);\r\n        return result;\r\n    }\r\n\r\n    async getDisciplineInternalAsync(\r\n        year: number,\r\n        termType: TermType,\r\n        course: number,\r\n        isModule: boolean,\r\n        total: number\r\n    ) {\r\n        const queryString = `?year=${year}&termType=${termType}&course=${course}&total=${total}&page=1&pageSize=${total}&search=`;\r\n        if (isModule) {\r\n            const paging = await this.requestApiJsonAsync<Paging<Discipline>>(\r\n                '/mvc/mobile/module/fetch' + queryString\r\n            );\r\n            const disciplines = paging.content;\r\n            for (const d of disciplines) {\r\n                d.isModule = true;\r\n            }\r\n            return disciplines;\r\n        } else {\r\n            const paging = await this.requestApiJsonAsync<Paging<Discipline>>(\r\n                '/mvc/mobile/discipline/fetch' + queryString\r\n            );\r\n            const disciplines = paging.content;\r\n            for (const d of disciplines) {\r\n                d.isModule = false;\r\n            }\r\n            return disciplines;\r\n        }\r\n    }\r\n\r\n    async getDisciplineTotalAsync(\r\n        year: number,\r\n        termType: TermType,\r\n        course: number,\r\n        isModule: boolean\r\n    ) {\r\n        const moduleParameter = isModule ? '&its=true' : '';\r\n        const queryString = `?year=${year}&termType=${termType}&course=${course}` + moduleParameter;\r\n        const total = await this.requestApiJsonAsync<number>(\r\n            '/mvc/mobile/discipline/amount' + queryString\r\n        );\r\n        return total;\r\n    }\r\n\r\n    async getAllStudentMarksAsync(discipline: Discipline) {\r\n        const students = [\r\n            ...(await this.getStudentMarksAsync(discipline, 'lecture', 'current')),\r\n            ...(await this.getStudentMarksAsync(discipline, 'lecture', 'intermediate')),\r\n            ...(await this.getStudentMarksAsync(discipline, 'laboratory', 'current')),\r\n            ...(await this.getStudentMarksAsync(discipline, 'laboratory', 'intermediate')),\r\n        ];\r\n\r\n        const uniqueStudents: { [id: string]: StudentMark } = {};\r\n        for (const s of students) {\r\n            const knownStudent = uniqueStudents[s.studentUuid] || {};\r\n            uniqueStudents[s.studentUuid] = {...knownStudent, ...s};\r\n        }\r\n\r\n        return Object.keys(uniqueStudents).map(k => uniqueStudents[k]);\r\n    }\r\n\r\n    async getStudentMarksAsync(\r\n        discipline: Discipline,\r\n        cardType: CardType,\r\n        markType: MarkType\r\n    ) {\r\n        return this.getStudentMarksInternalAsync(\r\n            discipline.disciplineLoad,\r\n            discipline.isModule,\r\n            discipline.groupHistoryId,\r\n            discipline.groupId,\r\n            cardType,\r\n            markType\r\n        );\r\n    }\r\n\r\n    async getStudentMarksInternalAsync(\r\n        disciplineLoad: string,\r\n        isModule: boolean,\r\n        groupUuid: string,\r\n        techgroup: string,\r\n        cardType: CardType,\r\n        markType: MarkType,\r\n        isTotal: boolean = false,\r\n        showActiveStudents: boolean = false\r\n    ) {\r\n        const groupPart = isModule\r\n            ? `techgroup=${techgroup}`\r\n            : `groupUuid=${groupUuid}`;\r\n        return this.requestApiJsonAsync<StudentMark[]>(\r\n            `/mvc/mobile/studentMarks/fetch?disciplineLoad=${disciplineLoad}&${groupPart}` +\r\n            `&cardType=${cardType}&hasTest=false&isTotal=${isTotal}` +\r\n            `&intermediate=${markType === 'intermediate'}` +\r\n            `&selectedTeachers=null&showActiveStudents=${showActiveStudents}`\r\n        );\r\n    }\r\n\r\n    async getAllControlActionsCachedAsync(discipline: Discipline) {\r\n        return [\r\n            ...(await this.getControlActionsCachedAsync(discipline, 'lecture', 'current')),\r\n            ...(await this.getControlActionsCachedAsync(\r\n                discipline,\r\n                'lecture',\r\n                'intermediate'\r\n            )),\r\n            ...(await this.getControlActionsCachedAsync(\r\n                discipline,\r\n                'laboratory',\r\n                'current'\r\n            )),\r\n            ...(await this.getControlActionsCachedAsync(\r\n                discipline,\r\n                'laboratory',\r\n                'intermediate'\r\n            )),\r\n            ...(await this.getControlActionsCachedAsync(discipline, 'practice', 'current')),\r\n            ...(await this.getControlActionsCachedAsync(\r\n                discipline,\r\n                'practice',\r\n                'intermediate'\r\n            )),\r\n            ...(await this.getControlActionsCachedAsync(\r\n                discipline,\r\n                'additionalPractice',\r\n                'current'\r\n            )),\r\n            ...(await this.getControlActionsCachedAsync(\r\n                discipline,\r\n                'additionalPractice',\r\n                'intermediate'\r\n            )),\r\n        ];\r\n    }\r\n\r\n    async getControlActionsCachedAsync(\r\n        discipline: Discipline,\r\n        cardType: CardType,\r\n        markType: MarkType\r\n    ) {\r\n        const cacheName = `${this.brsAuth.login}_getControlActions_${discipline.disciplineLoad}` +\r\n            `_${discipline.isModule}_${discipline.groupHistoryId}_${discipline.groupId}_${cardType}_${markType}`;\r\n        const cacheResult = cache.read<ControlAction[]>(cacheName, StorageType.Local);\r\n        if (cacheResult) {\r\n            return cacheResult;\r\n        }\r\n\r\n        const result = await this.getControlActionsInternalAsync(\r\n            discipline.disciplineLoad,\r\n            discipline.isModule,\r\n            discipline.groupHistoryId,\r\n            discipline.groupId,\r\n            cardType,\r\n            markType\r\n        );\r\n        cache.save(cacheName, result, StorageType.Local);\r\n        return result;\r\n    }\r\n\r\n    async getControlActionsInternalAsync(\r\n        disciplineLoad: string,\r\n        isModule: boolean,\r\n        groupUuid: string,\r\n        techgroup: string,\r\n        cardType: CardType,\r\n        markType: MarkType\r\n    ) {\r\n        const modulePart = isModule ? '/module' : '';\r\n        const groupPart = isModule ? techgroup : groupUuid;\r\n        const response = await this.requestApiAsync<string>(\r\n            `/mvc/mobile/view/mark/${disciplineLoad}/${groupPart}/teachers${modulePart}/${cardType}/${markType}`\r\n        );\r\n\r\n        const prefix = 'gridColumns = toTextArray(';\r\n        const suffix = ');';\r\n        const linesWithId = response\r\n            .split('\\r\\n')\r\n            .map(s => s.trim())\r\n            .filter(s => s.startsWith(prefix));\r\n        if (linesWithId.length !== 1) {\r\n            throw new Error(\r\n                'Control actions page should contain single line target line with techcard identifier'\r\n            );\r\n        }\r\n\r\n        const columns: Array<{ controlAction: string; uuid: string }> =\r\n            JSON.parse(\r\n                linesWithId[0].substr(\r\n                    prefix.length,\r\n                    linesWithId[0].length - prefix.length - suffix.length\r\n                )\r\n            ) || [];\r\n\r\n        const uuidPrefix = 'technologyCard';\r\n        const result = columns\r\n            .filter(c => c.uuid && c.uuid.startsWith(uuidPrefix))\r\n            .map(c => ({\r\n                uuid: c.uuid,\r\n                uuidWithoutPrefix: c.uuid.substr(uuidPrefix.length),\r\n                controlAction: c.controlAction,\r\n            }));\r\n        return result as ControlAction[];\r\n    }\r\n\r\n    async putStudentMarkAsync(\r\n        studentUuid: string,\r\n        controlActionId: string,\r\n        mark: number,\r\n        groupId: string,\r\n        cardTypeKey: CardType,\r\n        disciplineLoadUuid: string\r\n    ) {\r\n        const body = `student=${studentUuid}&techcard=${controlActionId}&mark=${\r\n            isNaN(mark) ? '' : mark.toString()\r\n        }&groupId=${groupId}&cardTypeKey=${cardTypeKey}&disciplineLoadUuid=${disciplineLoadUuid}`;\r\n        return this.requestApiJsonAsync<StudentMark>(\r\n            `/mvc/mobile/studentMarks/put`,\r\n            {\r\n                method: 'POST',\r\n                body,\r\n                json: false,\r\n            },\r\n            {\r\n                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\r\n            }\r\n        );\r\n    }\r\n\r\n    async putStudentFailureAsync(\r\n        studentUuid: string,\r\n        discipline: Discipline,\r\n        studentFailure: StudentFailure = StudentFailure.NoFailure,\r\n        cardType: CardType = 'lecture'\r\n    ) {\r\n        const body = `markFailure=${studentFailure}&cardType=${cardType}&disciplineLoad=${discipline.disciplineLoad}&studentId=${studentUuid}`;\r\n        await this.requestApiAsync(\r\n            `/mvc/mobile/failure/update`,\r\n            {\r\n                method: 'POST',\r\n                body,\r\n                json: false,\r\n            },\r\n            {\r\n                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\r\n            }\r\n        );\r\n    }\r\n\r\n    async updateAllMarksAsync(discipline: Discipline) {\r\n        // Одного вызова достаточно, чтобы обновить все оценки по предмету у группы.\r\n        await this.updateMarksAsync(discipline, 'lecture', 'intermediate');\r\n        // await updateMarksAsync(discipline, 'lecture', 'current');\r\n        // await updateMarksAsync(discipline, 'lecture', 'intermediate');\r\n        // await updateMarksAsync(discipline, 'laboratory', 'current');\r\n        // await updateMarksAsync(discipline, 'laboratory', 'intermediate');\r\n        // await updateMarksAsync(discipline, 'practice', 'current');\r\n        // await updateMarksAsync(discipline, 'practice', 'intermediate');\r\n    }\r\n\r\n    async updateMarksAsync(\r\n        discipline: Discipline,\r\n        cardType: CardType,\r\n        markType: MarkType\r\n    ) {\r\n        return this.updateMarksInternalAsync(\r\n            discipline.disciplineLoad,\r\n            discipline.isModule,\r\n            discipline.groupHistoryId,\r\n            discipline.groupId,\r\n            cardType,\r\n            markType\r\n        );\r\n    }\r\n\r\n    async updateMarksInternalAsync(\r\n        disciplineLoad: string,\r\n        isModule: boolean,\r\n        groupUuid: string,\r\n        techgroup: string,\r\n        cardType: CardType,\r\n        markType: MarkType\r\n    ) {\r\n        const modulePart = isModule ? '/module' : '';\r\n        const groupPart = isModule\r\n            ? `techgroup=${techgroup}`\r\n            : `groupUuid=${groupUuid}`;\r\n        const body =\r\n            `disciplineLoad=${disciplineLoad}&${groupPart}` +\r\n            `&cardType=${cardType}&hasTest=false&isTotal=false` +\r\n            `&intermediate=${markType === 'intermediate'}` +\r\n            `&selectedTeachers=null&showActiveStudents=true`;\r\n        return this.requestApiAsync<string>(\r\n            `/mvc/mobile/updateMarks${modulePart}`,\r\n            {\r\n                method: 'POST',\r\n                body,\r\n                json: false,\r\n            },\r\n            {\r\n                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\r\n            }\r\n        );\r\n    }\r\n\r\n    async requestApiJsonAsync<T>(\r\n        uri: string,\r\n        options?: RequestOptions,\r\n        headers?: RequestHeaders\r\n    ): Promise<T> {\r\n        const response = await this.requestApiAsync<string>(uri, options, headers);\r\n\r\n        return JSON.parse(response);\r\n    }\r\n\r\n    async requestApiAsync<T>(\r\n        uri: string,\r\n        options?: RequestOptions,\r\n        headers?: RequestHeaders\r\n    ): Promise<T> {\r\n        const response = await request({\r\n            method: 'GET',\r\n            ...options,\r\n            url: this.brsUrlProvider.baseUrl + uri,\r\n            headers: {\r\n                'X-Cookie': `JSESSIONID=${this.brsAuth.sid}`,\r\n                'X-Requested-With': 'XMLHttpRequest',\r\n                ...headers,\r\n            },\r\n        });\r\n\r\n        if (response.trimLeft().startsWith('<!DOCTYPE html>')) {\r\n            throw new CustomError(StatusCode.BrsUnauthorized, uri + ' is Forbidden');\r\n        }\r\n\r\n        return response;\r\n    }\r\n}\r\n\r\nexport enum StudentFailure {\r\n    /** -, дефис, все хорошо */ NoFailure = -1,\r\n    /** Не выбрана */ NotChosen = -19,\r\n    /** Не допущен (деканат) */ NotAllowedByDeansOffice = -18,\r\n    /** Не явился */ NotAppeared = 0,\r\n    /** Неуважительная */ DisrespectfulReason = 12,\r\n    /** Уважительная */ RespectfulReason = 13,\r\n    /** Не допущен */ NotAllowedByTeacher = 18,\r\n    /** Не должен сдавать */ ShouldNotPass = 19,\r\n    /** Академический отпуск */ AcademicLeave = 20,\r\n    /** Выбыл */ DroppedOut = 21,\r\n}\r\n\r\nexport enum TermType {\r\n    Fall = 1,\r\n    Spring = 2,\r\n}\r\n\r\nexport type CardType = 'lecture' | 'laboratory' | 'practice' | 'additionalPractice';\r\nexport type MarkType = 'intermediate' | 'current';\r\n\r\nexport interface RegisterInfo {\r\n    registerInfoStr: string;\r\n    registerId: number;\r\n    passDate: any;\r\n    cardType: string;\r\n    sheet: string;\r\n}\r\n\r\nexport interface Discipline {\r\n    groupId: string;\r\n    discipline: string;\r\n    group: string;\r\n    registerInfo: RegisterInfo[];\r\n    disciplineLoad: string;\r\n    groupHistoryId: string;\r\n    isModule: boolean;\r\n}\r\n\r\n// eslint-disable-next-line\r\nconst studentMarkSample: StudentMark = {\r\n    studentPersonalNumber: '09800106',\r\n    isEdit: false,\r\n    studentUuid:\r\n        'studen18hc2jg0000magk6mi3iec84bsundigr18hc2jg0000m53o7mlgvora278',\r\n    status: 1,\r\n    studentStatus: 'Активный',\r\n    ignoreCurrentDebars: false,\r\n    studentFio: 'Анисимова Маргарита Васильевна',\r\n    isExtern: false,\r\n    teacherName: '',\r\n    cardType: 'lecture',\r\n    studentName: 'Анисимова М.В.',\r\n    studentGroup: 'РИ-180001',\r\n    registerClosed: false,\r\n    subgroupsITS: '',\r\n    disciplineLoad: 'unpldd18hc2jg0000m5kojcd3te76bnk',\r\n};\r\n\r\nexport interface StudentMark {\r\n    studentPersonalNumber: string;\r\n    isEdit: boolean;\r\n    studentUuid: string;\r\n    status: number;\r\n    studentStatus: string;\r\n    ignoreCurrentDebars: boolean;\r\n    studentFio: string;\r\n    isExtern: boolean;\r\n    teacherName: string;\r\n    cardType: CardType;\r\n    studentName: string;\r\n    studentGroup: string;\r\n    registerClosed: boolean;\r\n    subgroupsITS: string;\r\n    disciplineLoad: string;\r\n    failure?: StudentFailure;\r\n    failureName?: string;\r\n\r\n    [props: string]: number | string | boolean | undefined;\r\n}\r\n\r\nexport interface ControlAction {\r\n    uuid: string;\r\n    uuidWithoutPrefix: string;\r\n    controlAction: string;\r\n}\r\n\r\ninterface RequestOptions {\r\n    method?: string;\r\n    body?: object | string;\r\n    json?: boolean;\r\n}\r\n\r\ninterface RequestHeaders {\r\n    'Content-Type'?: string;\r\n}\r\n\r\ninterface Paging<T> {\r\n    content: T[];\r\n    last: boolean;\r\n    totalPages: number;\r\n    totalElements: number;\r\n    size: number;\r\n    number: number;\r\n    sort: any;\r\n    first: boolean;\r\n    numberOfElements: number;\r\n}\r\n","import {Button, CircularProgress, TextField} from \"@material-ui/core\";\r\nimport SubmitWithLoading from \"../../submitWithLoading\";\r\nimport React, {FormEvent} from \"react\";\r\nimport \"./styles.css\"\r\n\r\nexport default function ({onSubmit, submitting, loading, signedIn, onLogout, username}: Props) {\r\n    const [login, setLogin] = React.useState('');\r\n    const [password, setPassword] = React.useState('');\r\n    const [sid, setSid] = React.useState('');\r\n\r\n    function handleUsernameChanged(e: React.ChangeEvent<HTMLInputElement>) {\r\n        const value = e.target.value;\r\n        setLogin(value);\r\n        setSid(\"\");\r\n    }\r\n\r\n    function handlePasswordChanged(e: React.ChangeEvent<HTMLInputElement>) {\r\n        const value = e.target.value;\r\n        setPassword(value);\r\n        setSid(\"\");\r\n    }\r\n\r\n    function handleSidChanged(e: React.ChangeEvent<HTMLInputElement>) {\r\n        const value = e.target.value;\r\n        setSid(value);\r\n        setLogin(\"\");\r\n        setPassword(\"\");\r\n    }\r\n\r\n    function handleSubmit(e: FormEvent) {\r\n        e.preventDefault();\r\n\r\n        if (loading)\r\n            return;\r\n\r\n        onSubmit({login: login, password, sid});\r\n    }\r\n\r\n    return signedIn ? (\r\n            <React.Fragment>\r\n                <p>Добро пожаловать, {username}</p>\r\n                <Button type=\"button\"\r\n                        fullWidth\r\n                        variant=\"contained\"\r\n                        onClick={onLogout}\r\n                        color=\"primary\">\r\n                    Выйти из БРС\r\n                </Button>\r\n            </React.Fragment>\r\n        ) :\r\n        (\r\n            <div className={\"brs-login-form\"}>\r\n                <form className=\"form\" onSubmit={handleSubmit}>\r\n                    <TextField\r\n                        className={\"form-component\"}\r\n                        variant=\"outlined\"\r\n                        margin=\"normal\"\r\n                        fullWidth\r\n                        id=\"username\"\r\n                        label=\"Имя пользователя\"\r\n                        name=\"username\"\r\n                        autoFocus\r\n                        value={login}\r\n                        disabled={loading}\r\n                        onChange={handleUsernameChanged}/>\r\n                    <TextField\r\n                        className={\"form-component\"}\r\n                        variant=\"outlined\"\r\n                        margin=\"normal\"\r\n                        fullWidth\r\n                        name=\"password\"\r\n                        label=\"Пароль\"\r\n                        type=\"password\"\r\n                        id=\"password\"\r\n                        autoComplete=\"current-password\"\r\n                        value={password}\r\n                        disabled={loading}\r\n                        onChange={handlePasswordChanged}/>\r\n                    <p className=\"text-center form-component\">или</p>\r\n                    <TextField\r\n                        className={\"form-component\"}\r\n                        variant=\"outlined\"\r\n                        margin=\"normal\"\r\n                        fullWidth\r\n                        name=\"sid\"\r\n                        label=\"JSESSIONID\"\r\n                        type=\"password\"\r\n                        id=\"sid\"\r\n                        value={sid}\r\n                        disabled={loading}\r\n                        onChange={handleSidChanged}/>\r\n                    <SubmitWithLoading className={\"vertical-margin-medium\"} title=\"войти\" loading={submitting}\r\n                                       disabled={loading}/>\r\n                </form>\r\n                {\r\n                    loading &&\r\n                    <CircularProgress color=\"primary\" size={150} className=\"progress\"/>\r\n                }\r\n            </div>\r\n        );\r\n}\r\n\r\ninterface Props {\r\n    submitting: boolean;\r\n    loading: boolean;\r\n    onSubmit: (credentials: Credentials) => void;\r\n    onLogout: () => void;\r\n    signedIn: boolean;\r\n    username?: string;\r\n}\r\n\r\nexport interface Credentials {\r\n    login: string\r\n    password: string\r\n    sid: string\r\n}\r\n","const CLIENT_ID = '122993083593-pacve8csj86voko30ia65raeg0ncrtuv.apps.googleusercontent.com';\r\nconst DISCOVERY_DOCS = [\"https://sheets.googleapis.com/$discovery/rest?version=v4\"];\r\nconst SCOPES = \"profile email https://www.googleapis.com/auth/spreadsheets\";\r\n\r\nconst googleAuth = {\r\n    async init() {\r\n        // @ts-ignore\r\n        if (gapi.client)\r\n            return;\r\n        return new Promise(resolve => {\r\n            gapi.load('client:auth2', async () => {\r\n                await gapi.client.init({\r\n                    clientId: CLIENT_ID,\r\n                    discoveryDocs: DISCOVERY_DOCS,\r\n                    scope: SCOPES\r\n                }).catch(console.error);\r\n                resolve();\r\n            });\r\n        });\r\n    },\r\n\r\n    checkAuthorized() {\r\n        // @ts-ignore\r\n        return gapi.auth2?.getAuthInstance()?.isSignedIn?.get();\r\n    },\r\n\r\n    getUsername(): string | undefined {\r\n        // @ts-ignore\r\n        const username = gapi.auth2?.getAuthInstance().currentUser?.get().getBasicProfile().getName();\r\n        if (username)\r\n            return username;\r\n\r\n        // @ts-ignore\r\n        return gapi.auth2?.getAuthInstance().currentUser?.get().getBasicProfile().getEmail();\r\n    },\r\n\r\n    async logout() {\r\n        // @ts-ignore\r\n        await gapi.auth2?.getAuthInstance()?.signOut();\r\n    }\r\n};\r\n\r\nexport default googleAuth;\r\n","import React from 'react';\r\nimport \"./styles.css\";\r\nimport {Redirect} from \"react-router-dom\";\r\nimport {Button, Container, Grid} from \"@material-ui/core\";\r\nimport GoogleLoginButton from \"./GoogleLoginButton\";\r\nimport CustomAlert from \"../CustomAlert\";\r\nimport BrsAuth, {LoginStatus} from \"../../apis/brsAuth\";\r\nimport BrsLoginForm, {Credentials} from \"./brsLoginForm\";\r\nimport googleAuth from \"../../apis/googleAuth\";\r\n\r\nexport default class LoginPage extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            brsLoading: true,\r\n            brsAuthorized: false,\r\n            googleAuthorized: false,\r\n            redirect: false,\r\n            submitLoading: false,\r\n            openAlert: false,\r\n            alertMessage: '',\r\n            alertType: 'error'\r\n        }\r\n\r\n    }\r\n\r\n    async componentDidMount() {\r\n        await this.props.brsAuth.tryRestoreAsync();\r\n        googleAuth.init();\r\n\r\n        const brsAuthorized = this.props.brsAuth.checkAuth();\r\n        const googleAuthorized = googleAuth.checkAuthorized();\r\n        this.setState({brsLoading: false, brsAuthorized, googleAuthorized});\r\n    }\r\n\r\n    handleBrsSubmit = async (credentials: Credentials) => {\r\n        this.setState({submitLoading: true});\r\n\r\n        const loginStatus = await this.loginBrsAsync(credentials);\r\n\r\n        this.setState({submitLoading: false})\r\n\r\n        switch (loginStatus) {\r\n            case LoginStatus.Succeed:\r\n                this.setState({\r\n                    alertMessage: \"Авторизация прошла успешно\",\r\n                    openAlert: true,\r\n                    alertType: 'success',\r\n                    brsAuthorized: true\r\n                });\r\n                break;\r\n            case LoginStatus.Error:\r\n                this.setState({\r\n                    alertMessage: \"Что-то пошло не так :( Попробуйте позже\",\r\n                    openAlert: true,\r\n                    alertType: 'error'\r\n                });\r\n                break;\r\n            case LoginStatus.InvalidCredentials:\r\n                this.setState({\r\n                    alertMessage: \"Неверные логин, пароль или JSESSIONID\",\r\n                    openAlert: true,\r\n                    alertType: 'error'\r\n                });\r\n        }\r\n    }\r\n\r\n    loginBrsAsync = async (credentials: Credentials): Promise<LoginStatus> => {\r\n        if (credentials.sid) {\r\n            return await this.props.brsAuth.authBySidAsync(credentials.sid);\r\n        }\r\n        if (credentials.login && credentials.password) {\r\n            return await this.props.brsAuth.loginAsync(credentials.login, credentials.password);\r\n        }\r\n        return LoginStatus.InvalidCredentials;\r\n    }\r\n\r\n    handleCloseAlert = () => {\r\n        this.setState({openAlert: false});\r\n    }\r\n\r\n    handleGoogleSignedIn = () => {\r\n        this.setState({googleAuthorized: true});\r\n    }\r\n\r\n    handleGoogleLoginFailed = (error: any) => {\r\n        console.error(error);\r\n\r\n        this.setState({\r\n            openAlert: true,\r\n            alertType: 'error',\r\n            alertMessage: 'Не удалось подключить Ваш Google аккаунт :('\r\n        });\r\n    }\r\n\r\n    startWork = () => {\r\n        this.setState({redirect: true});\r\n    }\r\n\r\n    handleBrsLogout = () => {\r\n        this.props.brsAuth.logout();\r\n        this.setState({\r\n            brsAuthorized: false,\r\n            alertMessage: \"Вы вышли из аккаунта БРС\",\r\n            alertType: \"success\",\r\n            openAlert: true\r\n        });\r\n    }\r\n\r\n    handleGoogleLogout = async () => {\r\n        await googleAuth.logout();\r\n        this.setState({\r\n            googleAuthorized: false,\r\n            alertType: \"success\",\r\n            alertMessage: \"Вы вышли из аккаунта Google\",\r\n            openAlert: true\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"login-page\">\r\n                {this.state.redirect && <Redirect to=\"/work\"/>}\r\n                <Container component=\"main\" maxWidth=\"md\">\r\n                    <h1>Привет!</h1>\r\n                    <h3>Как все работает</h3>\r\n                    <p>В Google Таблицах Вы заполняете оценки за курс по некоторому шаблону.<br/>\r\n                        После этого импортируете Google Таблицу в сервис и выполняете пробный запуск выставления оценок,\r\n                        чтобы исключить ошибки.<br/>\r\n                        Наконец делаете запуск с реальным выставлением оценок.</p>\r\n                    <p>Вы входите с БРС, чтобы сервис мог получить информацию о ваших курсах и выставлять оценки от\r\n                        вашего имени.<br/>\r\n                        Вы входите в Google, чтобы сервис мог загружать из ваших Google Таблиц оценки студентов.</p>\r\n                    <h3>Правила хранения данных</h3>\r\n                    <p>Ваш логин и пароль передаются в БРС через наш прокси для создания сессии в БРС.<br/>\r\n                        Данные о сессии БРС и о доступных Вам курсах сохраняются локально в вашем браузере.<br/>\r\n                        Остальные данные хранятся в рамках сессии в вашем браузере.</p>\r\n                    <hr/>\r\n                    <p className={\"align-center\"}>Авторизуйтесь в БРС и Google, чтобы начать работу в сервисе</p>\r\n                    <Grid container justify=\"space-around\" className={\"vertical-margin-medium\"}>\r\n                        <Grid item md={5} lg={5} sm={5} xs={10}>\r\n                            <BrsLoginForm onSubmit={this.handleBrsSubmit}\r\n                                          loading={this.state.brsLoading}\r\n                                          signedIn={this.state.brsAuthorized}\r\n                                          onLogout={this.handleBrsLogout}\r\n                                          username={this.props.brsAuth.username}\r\n                                          submitting={this.state.submitLoading}/>\r\n                        </Grid>\r\n                        <Grid item className=\"align-center\">\r\n                            <GoogleLoginButton onSignedIn={this.handleGoogleSignedIn}\r\n                                               signedIn={this.state.googleAuthorized}\r\n                                               username={googleAuth.getUsername()}\r\n                                               onLogout={this.handleGoogleLogout}\r\n                                               onFailure={this.handleGoogleLoginFailed}/>\r\n                            <br/>\r\n                        </Grid>\r\n                    </Grid>\r\n                    <Container className=\"start-work-wrapper\">\r\n                        <Button variant=\"contained\"\r\n                                onClick={this.startWork}\r\n                                disabled={!this.state.brsAuthorized || !this.state.googleAuthorized}\r\n                                color=\"secondary\">\r\n                            начать работу\r\n                        </Button>\r\n                    </Container>\r\n                    <CustomAlert open={this.state.openAlert}\r\n                                 message={this.state.alertMessage}\r\n                                 type={this.state.alertType}\r\n                                 onClose={this.handleCloseAlert}/>\r\n                </Container>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\ninterface State {\r\n    brsLoading: boolean;\r\n    brsAuthorized: boolean;\r\n    googleAuthorized: boolean;\r\n    submitLoading: boolean;\r\n    redirect: boolean;\r\n    openAlert: boolean,\r\n    alertMessage: string,\r\n    alertType: \"error\" | \"success\";\r\n}\r\n\r\ninterface Props {\r\n    brsAuth: BrsAuth;\r\n}\r\n","import React from \"react\";\r\nimport Context from \"../../Context\";\r\nimport LoginPage from \"./index\";\r\nimport BrsAuth from \"../../apis/brsAuth\";\r\n\r\nexport default function () {\r\n    return (\r\n        <Context.Consumer>\r\n            {\r\n                context => <LoginPage brsAuth={(context as { brsAuth: BrsAuth }).brsAuth}/>\r\n            }\r\n        </Context.Consumer>\r\n    );\r\n}\r\n","export function getSpreadsheet(spreadsheetId: string): Spreadsheet {\r\n    // @ts-ignore\r\n    const sheets = gapi.client.sheets;\r\n\r\n    async function readAsync(range: string) {\r\n        const response = await sheets.spreadsheets.values.get({\r\n            spreadsheetId,\r\n            range,\r\n        });\r\n        return response.result;\r\n    }\r\n\r\n    function writeAsync(range: string, values: any[][], asEnteredByUser = false) {\r\n        const valueInputOption = asEnteredByUser ? \"USER_ENTERED\" : \"RAW\";\r\n        const requestBody = {\r\n            values,\r\n        };\r\n        return sheets.spreadsheets.values.update({\r\n            spreadsheetId,\r\n            range,\r\n            valueInputOption,\r\n            requestBody,\r\n        });\r\n    }\r\n\r\n    function appendAsync(\r\n        range: string,\r\n        values: any[][],\r\n        asEnteredByUser = false\r\n    ) {\r\n        const valueInputOption = asEnteredByUser ? \"USER_ENTERED\" : \"RAW\";\r\n        const requestBody = {\r\n            values,\r\n        };\r\n        return sheets.spreadsheets.values.append({\r\n            spreadsheetId,\r\n            range,\r\n            valueInputOption,\r\n            requestBody,\r\n        });\r\n    }\r\n\r\n    return {\r\n        readAsync,\r\n        writeAsync,\r\n        appendAsync,\r\n    };\r\n}\r\n\r\nexport async function getSpreadsheetProperties(spreadsheetId: string): Promise<SpreadsheetProperties[]> {\r\n    // @ts-ignore\r\n    const sheets = gapi.client.sheets;\r\n\r\n    const res = await sheets.spreadsheets.get({spreadsheetId});\r\n    const sheetProps = JSON.parse(res.body).sheets as [{ properties: SpreadsheetProperties }];\r\n    return sheetProps.map(s => s.properties)\r\n}\r\n\r\nexport interface Spreadsheet {\r\n    readAsync: (range: string) => Promise<ValueRange>;\r\n    writeAsync: (\r\n        range: string,\r\n        values: any[][],\r\n        asEnteredByUser?: boolean\r\n    ) => Promise<any>;\r\n    appendAsync: (\r\n        range: string,\r\n        values: any[][],\r\n        asEnteredByUser?: boolean\r\n    ) => Promise<any>;\r\n}\r\n\r\nexport interface ValueRange {\r\n    majorDimension?: string | null;\r\n    range?: string | null;\r\n    values?: any[][] | null;\r\n}\r\n\r\nexport interface SpreadsheetProperties {\r\n    sheetId: number;\r\n    title: string;\r\n}\r\n","export function fixSpaces(str: string) {\r\n    return str && str.replace(/[\\s]/g, ' ');\r\n}\r\n\r\nexport function normalizeString(str: string) {\r\n    return (\r\n        str &&\r\n        str\r\n            .toLowerCase()\r\n            .replace('ё', 'е')\r\n            .replace(/[^A-Za-zА-ЯЁа-яё0-9]/g, '')\r\n    );\r\n}\r\n\r\nexport function compareNormalized(s1: string, s2: string) {\r\n    return normalizeString(s1) === normalizeString(s2);\r\n}\r\n\r\nexport function parseAnyFloat(s: string) {\r\n    return parseFloat(s && s.replace(',', '.'));\r\n}\r\n\r\nexport function groupBy<TItem, TKey>(items: TItem[], key: keyof TItem) {\r\n    const reducer: { [group: string]: TItem[] } = {};\r\n    return items.reduce((reducer, item) => {\r\n        const itemKey = `${item[key]}`;\r\n        (reducer[itemKey] = reducer[itemKey] || []).push(item);\r\n        return reducer;\r\n    }, reducer);\r\n}\r\n","import { StudentFailure } from '../apis/brsApi';\r\nimport { compareNormalized } from './tools';\r\n\r\nconst failureMapping: { [key: string]: StudentFailure } = {\r\n    '-': StudentFailure.NoFailure,\r\n    'Не выбрана': StudentFailure.NotChosen,\r\n    'Не допущен (деканат)': StudentFailure.NotAllowedByDeansOffice,\r\n    'Не явился': StudentFailure.NotAppeared,\r\n    Неуважительная: StudentFailure.DisrespectfulReason,\r\n    Уважительная: StudentFailure.RespectfulReason,\r\n    'Не допущен': StudentFailure.NotAllowedByTeacher,\r\n    'Не должен сдавать': StudentFailure.ShouldNotPass,\r\n    'Академический отпуск': StudentFailure.AcademicLeave,\r\n    Выбыл: StudentFailure.DroppedOut,\r\n};\r\n\r\nexport function parseStudentFailure(input: string): StudentFailure | null {\r\n    if (input === null || input === undefined) {\r\n        return null;\r\n    }\r\n\r\n    for (let key of Object.keys(failureMapping)) {\r\n        if (compareNormalized(key, input)) {\r\n            return failureMapping[key];\r\n        }\r\n    }\r\n\r\n    return StudentFailure.NoFailure;\r\n}\r\n\r\nexport function formatStudentFailure(\r\n    input: StudentFailure | null | undefined\r\n): string | null {\r\n    if (input === null || input === undefined) {\r\n        return null;\r\n    }\r\n\r\n    for (let key of Object.keys(failureMapping)) {\r\n        if (failureMapping[key] === input) {\r\n            return key;\r\n        }\r\n    }\r\n\r\n    return '-';\r\n}\r\n","import { StudentFailure } from '../apis/brsApi';\r\nimport * as googleApi from '../apis/googleApi';\r\nimport { parseStudentFailure } from '../helpers/brsHelpers';\r\n\r\nexport interface ActualStudent {\r\n    fullName: string;\r\n    groupName: string;\r\n    id: string | null;\r\n    failure: StudentFailure | null;\r\n    properties: string[];\r\n}\r\n\r\nexport async function fromSpreadsheetAsync(\r\n    spreadsheetId: string,\r\n    readRange: string,\r\n    fullNameIndex: number = 0,\r\n    groupNameIndex: number = 1,\r\n    idIndex: number | null = null,\r\n    failureIndex: number | null = null\r\n) {\r\n    const sheet = googleApi.getSpreadsheet(spreadsheetId);\r\n\r\n    const rows = (await sheet.readAsync(readRange)).values || [];\r\n\r\n    const result: ActualStudent[] = [];\r\n    for (const row of rows) {\r\n        const fullName = row[fullNameIndex];\r\n        const groupName = row[groupNameIndex];\r\n        const id = idIndex !== null ? row[idIndex] : null;\r\n        const failure =\r\n            failureIndex !== null\r\n                ? parseStudentFailure(row[failureIndex])\r\n                : null;\r\n        if (fullName && groupName) {\r\n            result.push({\r\n                fullName,\r\n                groupName,\r\n                id: id,\r\n                failure: failure,\r\n                properties: row,\r\n            });\r\n        }\r\n    }\r\n    return result;\r\n}\r\n","import {Discipline, StudentFailure, TermType} from '../apis/brsApi';\r\nimport {ControlActionConfig} from '../marksActions/MarksManager';\r\nimport * as readStudents from './readStudentsAsync';\r\nimport {ActualStudent} from './readStudentsAsync';\r\nimport * as googleApi from '../apis/googleApi';\r\nimport {compareNormalized, normalizeString} from '../helpers/tools';\r\nimport {parseStudentFailure} from '../helpers/brsHelpers';\r\n\r\nexport default async function getSpreadsheetDataAsync(\r\n    spreadsheetId: string,\r\n    sheetName: string,): Promise<SpreadsheetData> {\r\n\r\n    const rows = await readRowsFromSpreadsheetAsync(spreadsheetId, sheetName);\r\n    const header = getHeader(rows);\r\n\r\n    const indices = buildIndicesBy(header);\r\n    const dataRange = buildDataRange(sheetName, indices);\r\n    const controlActionConfigs = buildControlActionConfig(header, indices);\r\n    const disciplineConfig = buildDisciplineConfig(\r\n        rows,\r\n        indices,\r\n        null\r\n    );\r\n\r\n    const actualStudents = await readStudents.fromSpreadsheetAsync(\r\n        spreadsheetId,\r\n        dataRange,\r\n        indices.fullNameColumn - indices.left,\r\n        indices.groupColumn - indices.left,\r\n        null,\r\n        indices.failureColumn - indices.left\r\n    );\r\n\r\n    return {\r\n        actualStudents,\r\n        disciplineConfig,\r\n        controlActionConfigs,\r\n    };\r\n}\r\n\r\nasync function readRowsFromSpreadsheetAsync(\r\n    spreadsheetId: string,\r\n    sheetName: string\r\n) {\r\n    const sheet = googleApi.getSpreadsheet(spreadsheetId);\r\n    const rows = (await sheet.readAsync(sheetName + '!A1:ZZ100'))\r\n        .values as string[][];\r\n    return rows || null;\r\n}\r\n\r\nfunction getHeader(rows: string[][]) {\r\n    const header = rows && rows[0];\r\n    if (!header) throw new Error(`Can't read header of spreadsheet`);\r\n    return header;\r\n}\r\n\r\nfunction buildIndicesBy(header: string[]): Indices {\r\n    const defaultGroupColumnName = 'Группа в БРС';\r\n    const defaultFullNameColumnName = 'Фамилия Имя в БРС';\r\n    const defaultFailureColumnName = 'Причина отсутствия';\r\n    const disciplineParameterKeyColumnPrefix = 'Названия параметров';\r\n    const disciplineParameterValueColumnPrefix = 'Значения параметров';\r\n\r\n    const normalizedHeader = header && header.map((s) => normalizeString(s));\r\n    const groupColumnIndex = normalizedHeader.indexOf(\r\n        normalizeString(defaultGroupColumnName)\r\n    );\r\n    const fullNameColumnIndex = normalizedHeader.indexOf(\r\n        normalizeString(defaultFullNameColumnName)\r\n    );\r\n    const failureColumnIndex = normalizedHeader.indexOf(\r\n        normalizeString(defaultFailureColumnName)\r\n    );\r\n    const disciplineParameterKeyColumnIndex = normalizedHeader.indexOf(\r\n        normalizeString(disciplineParameterKeyColumnPrefix)\r\n    );\r\n    const disciplineParameterValueColumnIndex = normalizedHeader.indexOf(\r\n        normalizeString(disciplineParameterValueColumnPrefix)\r\n    );\r\n\r\n    if (\r\n        failureColumnIndex < 0 ||\r\n        groupColumnIndex < 0 ||\r\n        fullNameColumnIndex < 0 ||\r\n        groupColumnIndex > failureColumnIndex ||\r\n        fullNameColumnIndex > failureColumnIndex ||\r\n        Math.abs(fullNameColumnIndex - groupColumnIndex) !== 1 ||\r\n        disciplineParameterKeyColumnIndex < 0 ||\r\n        disciplineParameterValueColumnIndex < 0 ||\r\n        disciplineParameterKeyColumnIndex <= failureColumnIndex ||\r\n        disciplineParameterValueColumnIndex <= failureColumnIndex ||\r\n        disciplineParameterValueColumnIndex !==\r\n        disciplineParameterKeyColumnIndex + 1\r\n    )\r\n        throw new Error(`Wrong order of columns`);\r\n    const leftIndex = Math.min(groupColumnIndex, fullNameColumnIndex);\r\n    const rightIndex = failureColumnIndex;\r\n\r\n    return {\r\n        groupColumn: groupColumnIndex,\r\n        fullNameColumn: fullNameColumnIndex,\r\n        failureColumn: failureColumnIndex,\r\n        disciplineKeyColumn: disciplineParameterKeyColumnIndex,\r\n        disciplineValueColumn: disciplineParameterValueColumnIndex,\r\n        left: leftIndex,\r\n        right: rightIndex,\r\n    };\r\n}\r\n\r\nfunction buildDataRange(sheetName: string, indices: Indices) {\r\n    const leftLetter = String.fromCharCode('A'.charCodeAt(0) + indices.left);\r\n    const rightLetter = String.fromCharCode('A'.charCodeAt(0) + indices.right);\r\n    return `${sheetName}!${leftLetter}2:${rightLetter}`;\r\n}\r\n\r\nfunction buildControlActionConfig(header: string[], indices: Indices) {\r\n    const controlActionConfigs: ControlActionConfig[] = [];\r\n    for (let index = indices.left; index <= indices.right; index++) {\r\n        if (\r\n            index === indices.groupColumn ||\r\n            index === indices.fullNameColumn ||\r\n            index === indices.failureColumn ||\r\n            !header[index]\r\n        ) {\r\n            continue;\r\n        }\r\n        controlActionConfigs.push({\r\n            controlActions: [header[index]],\r\n            propertyIndex: index - indices.left,\r\n        });\r\n    }\r\n\r\n    for (const config of controlActionConfigs) {\r\n        if (config.controlActions.length === 1) {\r\n            const sameColumns = controlActionConfigs.filter(\r\n                (c) =>\r\n                    c.controlActions.length === 1 &&\r\n                    compareNormalized(\r\n                        c.controlActions[0],\r\n                        config.controlActions[0]\r\n                    )\r\n            );\r\n            if (sameColumns.length > 1) {\r\n                config.matchCount = sameColumns.length;\r\n                for (\r\n                    let matchIndex = 0;\r\n                    matchIndex < sameColumns.length;\r\n                    matchIndex++\r\n                ) {\r\n                    sameColumns[matchIndex].matchIndex = matchIndex;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return controlActionConfigs;\r\n}\r\n\r\nfunction buildDisciplineConfig(\r\n    rows: string[][],\r\n    indices: Indices,\r\n    isSuitableDiscipline: ((d: Discipline) => boolean) | null\r\n) {\r\n    const result: DisciplineConfig = {\r\n        name: '',\r\n        year: 0,\r\n        termType: TermType.Fall,\r\n        course: 1,\r\n        isModule: false,\r\n        defaultStudentFailure: StudentFailure.NoFailure,\r\n        isSuitableDiscipline: null,\r\n    };\r\n\r\n    for (let i = 0; i < rows.length; i++) {\r\n        const key = rows[i][indices.disciplineKeyColumn]?.trim();\r\n        if (!key) {\r\n            break;\r\n        }\r\n        const value = rows[i][indices.disciplineValueColumn]?.trim();\r\n        addDisciplineConfigParameter(result, key, value);\r\n    }\r\n\r\n    result.isSuitableDiscipline = isSuitableDiscipline;\r\n    return result;\r\n}\r\n\r\nfunction addDisciplineConfigParameter(\r\n    config: DisciplineConfig,\r\n    key: string,\r\n    value: string\r\n) {\r\n    if (compareNormalized(key, 'Дисциплина')) {\r\n        if (value) {\r\n            config.name = value;\r\n        }\r\n    } else if (compareNormalized(key, 'ИТС')) {\r\n        if (value) {\r\n            config.isModule = value.toLowerCase() === 'да';\r\n        }\r\n    } else if (compareNormalized(key, 'Год')) {\r\n        if (value) {\r\n            config.year = parseInt(value.toLowerCase(), 10);\r\n        }\r\n    } else if (compareNormalized(key, 'Семестр')) {\r\n        if (value) {\r\n            if (value.toLowerCase() === 'осенний') {\r\n                config.termType = TermType.Fall;\r\n            } else if (value.toLowerCase() === 'весенний') {\r\n                config.termType = TermType.Spring;\r\n            }\r\n        }\r\n    } else if (compareNormalized(key, 'Курс')) {\r\n        if (value) {\r\n            const lowerValue = value.toLowerCase().trim();\r\n            if (lowerValue === 'все курсы') {\r\n                config.course = 0;\r\n            } else {\r\n                config.course = parseInt(value.toLowerCase(), 10);\r\n            }\r\n        }\r\n    } else if (compareNormalized(key, 'Причина отсутствия по умолчанию')) {\r\n        config.defaultStudentFailure =\r\n            parseStudentFailure(value) ?? StudentFailure.NoFailure;\r\n    }\r\n}\r\n\r\nexport interface SpreadsheetData {\r\n    actualStudents: ActualStudent[];\r\n    disciplineConfig: DisciplineConfig;\r\n    controlActionConfigs: ControlActionConfig[];\r\n}\r\n\r\nexport interface DisciplineConfig {\r\n    name: string;\r\n    year: number;\r\n    termType: number;\r\n    course: number;\r\n    isModule: boolean;\r\n    defaultStudentFailure: StudentFailure;\r\n    isSuitableDiscipline: ((d: Discipline) => boolean) | null;\r\n}\r\n\r\ninterface Indices {\r\n    groupColumn: number;\r\n    fullNameColumn: number;\r\n    failureColumn: number;\r\n    disciplineKeyColumn: number;\r\n    disciplineValueColumn: number;\r\n    left: number;\r\n    right: number;\r\n}\r\n","import React from 'react';\r\nimport {Collapse, List, ListItem, ListItemIcon, ListItemText, ListSubheader} from '@material-ui/core';\r\nimport {ExpandLess, ExpandMore} from '@material-ui/icons';\r\nimport GroupIcon from '@material-ui/icons/Group';\r\nimport ViewModuleIcon from '@material-ui/icons/ViewModule';\r\nimport \"./styles.css\"\r\n\r\nexport default function NestedList(props: NestedListProps) {\r\n    const {title, items, collapsed = true} = props;\r\n\r\n    const listSubheader = (\r\n        <ListSubheader component=\"div\" id=\"nested-list-subheader\" hidden={!title}>\r\n            {title}\r\n        </ListSubheader>\r\n    );\r\n\r\n    return (\r\n        <List\r\n            component=\"nav\"\r\n            aria-labelledby=\"nested-list-subheader\"\r\n            subheader={listSubheader}\r\n            className={\"nested-list primary\"}>\r\n            {\r\n                items.length ?\r\n                    ConstructItems(items, collapsed) :\r\n                    <ListItem className={\"align-center\"}>\r\n                        <ListItemText primary=\"No items\"/>\r\n                    </ListItem>\r\n            }\r\n        </List>\r\n    );\r\n}\r\n\r\nfunction ConstructItems(items: INestedListItem[], collapsed: boolean) {\r\n    return items.map((item, index) => (\r\n        <Item key={index}\r\n              item={item}\r\n              collapsed={collapsed}/>\r\n    ));\r\n}\r\n\r\nfunction Item({item, collapsed}: ItemProps) {\r\n    const [open, setOpen] = React.useState(!collapsed);\r\n\r\n    const {title, nestedItems} = item;\r\n\r\n    const hasSubItems = nestedItems && nestedItems.length > 0;\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <ListItem button onClick={() => setOpen(!open)} className={\"primary hover\"}>\r\n                <ListItemIcon>\r\n                    <ViewModuleIcon/>\r\n                </ListItemIcon>\r\n                <ListItemText primary={title}/>\r\n                {hasSubItems && (open ? <ExpandLess/> : <ExpandMore/>)}\r\n            </ListItem>\r\n            {\r\n                nestedItems?.map((nestedItem, index) =>\r\n                    <NestedItem {...{index, open, title: nestedItem.title, colored: nestedItem.colored}}/>)\r\n            }\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nfunction NestedItem({index, title, open, colored}: NestedItemProps) {\r\n    const color = colored && \"colored-back\";\r\n\r\n    return (\r\n        <Collapse key={index} in={open} timeout=\"auto\" unmountOnExit>\r\n            <List component=\"div\" disablePadding>\r\n                <ListItem className={\"nested-item \" + color}>\r\n                    <ListItemIcon>\r\n                        <GroupIcon/>\r\n                    </ListItemIcon>\r\n                    <ListItemText primary={title}/>\r\n                </ListItem>\r\n            </List>\r\n        </Collapse>\r\n    );\r\n}\r\n\r\nexport interface INestedListItem {\r\n    title: string;\r\n    nestedItems?: INestedItem[];\r\n}\r\n\r\nexport interface INestedItem {\r\n    title: string;\r\n    colored?: boolean;\r\n}\r\n\r\ninterface ItemsProps {\r\n    items: INestedListItem[];\r\n    collapsed?: boolean;\r\n}\r\n\r\ninterface NestedListProps extends ItemsProps {\r\n    title?: string;\r\n}\r\n\r\ninterface ItemProps {\r\n    item: INestedListItem;\r\n    collapsed?: boolean;\r\n}\r\n\r\ninterface NestedItemProps {\r\n    index: number;\r\n    title: string;\r\n    open: boolean;\r\n    colored?: boolean;\r\n}\r\n","import BrsApi from '../apis/brsApi';\r\nimport {compareNormalized} from '../helpers/tools';\r\nimport {DisciplineConfig} from \"./getSpreadsheetDataAsync\";\r\n\r\nexport default async function getSuitableDisciplinesAsync(brsApi: BrsApi, disciplineConfig: DisciplineConfig) {\r\n    const allDisciplines = await brsApi.getDisciplineCachedAsync(\r\n        disciplineConfig.year,\r\n        disciplineConfig.termType,\r\n        disciplineConfig.course,\r\n        disciplineConfig.isModule\r\n    );\r\n\r\n    return allDisciplines.filter(\r\n        (d) =>\r\n            compareNormalized(d.discipline, disciplineConfig.name) &&\r\n            (!disciplineConfig.isSuitableDiscipline ||\r\n                disciplineConfig.isSuitableDiscipline(d))\r\n    );\r\n}\r\n","import {Button, Grid} from \"@material-ui/core\";\r\nimport React from \"react\";\r\n\r\nexport default function ({enabled, onRunWorkSafe, onRunWorkUnsafe}: Props) {\r\n    return (\r\n        <Grid container justify=\"space-around\">\r\n            <Grid item>\r\n                <Button variant=\"contained\"\r\n                        disabled={!enabled}\r\n                        onClick={onRunWorkSafe}\r\n                        color=\"primary\">\r\n                    Попробуй сделать хорошо\r\n                </Button>\r\n            </Grid>\r\n            <Grid item>\r\n                <Button variant=\"contained\"\r\n                        disabled={!enabled}\r\n                        onClick={onRunWorkUnsafe}\r\n                        color=\"secondary\">\r\n                    Сделай хорошо\r\n                </Button>\r\n            </Grid>\r\n        </Grid>\r\n    );\r\n}\r\n\r\ninterface Props {\r\n    enabled: boolean;\r\n    onRunWorkSafe: () => void;\r\n    onRunWorkUnsafe: () => void;\r\n}\r\n","export function toShow(fio: string) {\r\n    return fio.replace('ё', 'е').replace(/[ ]+/, ' ');\r\n}\r\n\r\nexport function toKey(fio: string) {\r\n    return fio.toLowerCase().replace('ё', 'е').replace(/[ ]+/, ' ').trim();\r\n}\r\n","import BrsApi, {ControlAction, Discipline, StudentFailure, StudentMark} from '../apis/brsApi';\r\nimport {compareNormalized, parseAnyFloat} from '../helpers/tools';\r\nimport * as fio from '../helpers/fio';\r\nimport {ActualStudent} from '../functions/readStudentsAsync';\r\nimport {formatStudentFailure} from '../helpers/brsHelpers';\r\nimport {Logger} from '../helpers/logger';\r\nimport {SpreadsheetData} from \"../functions/getSpreadsheetDataAsync\";\r\n\r\nexport default class MarksManager {\r\n    private readonly brsApi: BrsApi;\r\n    private readonly options: PutMarksOptions;\r\n    readonly logger: Logger;\r\n    private cancelPending: boolean = false;\r\n\r\n    constructor(brsApi: BrsApi, logger: Logger, options: PutMarksOptions) {\r\n        this.brsApi = brsApi;\r\n        this.logger = logger;\r\n        this.options = options;\r\n    }\r\n\r\n    cancel() {\r\n        this.cancelPending = true;\r\n    }\r\n\r\n    getLogger() {\r\n        return this.logger;\r\n    }\r\n\r\n    async putMarksToBrsAsync(spreadsheetData: SpreadsheetData, suitableDisciplines: Discipline[]) {\r\n        const {\r\n            actualStudents,\r\n            disciplineConfig,\r\n            controlActionConfigs,\r\n        } = spreadsheetData;\r\n\r\n        try {\r\n            for (const discipline of suitableDisciplines) {\r\n                await this.putMarksForDisciplineAsync(\r\n                    discipline,\r\n                    actualStudents.filter((s) =>\r\n                        compareNormalized(s.groupName, discipline.group)\r\n                    ),\r\n                    disciplineConfig.defaultStudentFailure,\r\n                    controlActionConfigs\r\n                );\r\n                if (this.cancelPending) {\r\n                    break;\r\n                }\r\n            }\r\n        } catch (e) {\r\n            this.logger.error(e);\r\n        }\r\n    }\r\n\r\n    async putMarksForDisciplineAsync(\r\n        discipline: Discipline,\r\n        actualStudents: ActualStudent[],\r\n        defaultStudentFailure: StudentFailure,\r\n        controlActionConfigs: ControlActionConfig[]\r\n    ) {\r\n        if (actualStudents.length === 0) return;\r\n        this.logger.log(`# Processing group ${discipline.group}`);\r\n        this.logger.log('');\r\n\r\n        const controlActions = await this.brsApi.getAllControlActionsCachedAsync(\r\n            discipline\r\n        );\r\n        if (\r\n            !this.checkControlActionsConfiguration(\r\n                controlActions,\r\n                controlActionConfigs\r\n            )\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        const brsStudents = await this.brsApi.getAllStudentMarksAsync(\r\n            discipline\r\n        );\r\n        const {\r\n            mergedStudents,\r\n            skippedActualStudents,\r\n            skippedBrsStudents,\r\n        } = this.mergeStudents(actualStudents, brsStudents);\r\n        this.logMergedStudents(\r\n            mergedStudents,\r\n            skippedActualStudents,\r\n            skippedBrsStudents\r\n        );\r\n        this.logger.log('');\r\n\r\n        await this.putMarksForStudentsAsync(\r\n            discipline,\r\n            mergedStudents,\r\n            controlActionConfigs,\r\n            controlActions\r\n        );\r\n        this.logger.log('');\r\n\r\n        await this.updateFailuresForSkippedStudentsAsync(\r\n            skippedBrsStudents,\r\n            discipline,\r\n            defaultStudentFailure\r\n        );\r\n        this.logger.log('');\r\n\r\n        if (this.options.save) {\r\n            await this.brsApi.updateAllMarksAsync(discipline);\r\n        }\r\n\r\n        this.logger.log('');\r\n    }\r\n\r\n    checkControlActionsConfiguration(\r\n        controlActions: ControlAction[],\r\n        controlActionConfigs: ControlActionConfig[]\r\n    ) {\r\n        for (const config of controlActionConfigs) {\r\n            if (!this.getSuitableControlAction(config, controlActions)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    async putMarksForStudentsAsync(\r\n        discipline: Discipline,\r\n        students: MergedStudent[],\r\n        controlActionConfigs: ControlActionConfig[],\r\n        controlActions: ControlAction[]\r\n    ) {\r\n        const statusCounters: { [k: string]: number } = {};\r\n\r\n        for (const student of students) {\r\n            const status = await this.putMarksForStudentAsync(\r\n                discipline,\r\n                student,\r\n                controlActionConfigs,\r\n                controlActions\r\n            );\r\n            if (statusCounters[status] === undefined) {\r\n                statusCounters[status] = 0;\r\n            }\r\n            statusCounters[status]++;\r\n        }\r\n\r\n        this.logger.log('Marks update statuses:');\r\n        for (const k of Object.keys(statusCounters)) {\r\n            this.logger.log(`- ${k} = ${statusCounters[k]}`);\r\n        }\r\n    }\r\n\r\n    async putMarksForStudentAsync(\r\n        discipline: Discipline,\r\n        student: MergedStudent,\r\n        controlActionConfigs: ControlActionConfig[],\r\n        controlActions: ControlAction[]\r\n    ) {\r\n        let updated = 0;\r\n        let failed = 0;\r\n\r\n        const marks = [];\r\n        for (const config of controlActionConfigs) {\r\n            const controlAction = this.getSuitableControlAction(\r\n                config,\r\n                controlActions\r\n            );\r\n            if (!controlAction) {\r\n                throw new Error();\r\n            }\r\n\r\n            const brsMark = parseAnyFloat(\r\n                student.brs[controlAction.uuid] as string\r\n            );\r\n            const actualMark = parseAnyFloat(\r\n                student.actual.properties[config.propertyIndex]\r\n            );\r\n\r\n            if (actualMark === brsMark || actualMark === 0) {\r\n                marks.push(\r\n                    `    ${actualMark} `.substr(`${actualMark}`.length - 1)\r\n                );\r\n                continue;\r\n            } else {\r\n                marks.push(\r\n                    `    ${actualMark}!`.substr(`${actualMark}`.length - 1)\r\n                );\r\n            }\r\n\r\n            try {\r\n                if (this.options.save) {\r\n                    await this.brsApi.putStudentMarkAsync(\r\n                        student.brs.studentUuid,\r\n                        controlAction.uuidWithoutPrefix,\r\n                        actualMark,\r\n                        discipline.groupHistoryId,\r\n                        student.brs.cardType,\r\n                        student.brs.disciplineLoad\r\n                    );\r\n                }\r\n                updated++;\r\n            } catch (error) {\r\n                failed++;\r\n            }\r\n        }\r\n\r\n        const brsFailureStatus =\r\n            (student.brs.failure as StudentFailure) ?? StudentFailure.NoFailure;\r\n        const actualFailure =\r\n            student.actual.failure ?? StudentFailure.NoFailure;\r\n        let failureStatus = '';\r\n        if (actualFailure === brsFailureStatus) {\r\n            failureStatus = `${formatStudentFailure(actualFailure)}`;\r\n        } else {\r\n            failureStatus = `${formatStudentFailure(actualFailure)}!`;\r\n            try {\r\n                if (this.options.save) {\r\n                    await this.brsApi.putStudentFailureAsync(\r\n                        student.brs.studentUuid,\r\n                        discipline,\r\n                        actualFailure\r\n                    );\r\n                }\r\n                updated++;\r\n            } catch (error) {\r\n                failed++;\r\n            }\r\n        }\r\n\r\n        const status =\r\n            failed > 0 ? 'FAILED ' : updated > 0 ? 'UPDATED' : 'SKIPPED';\r\n        if (this.options.verbose || failed > 0) {\r\n            const studentName = (\r\n                student.actual.fullName + '                              '\r\n            ).substr(0, 30);\r\n            this.logger.log(\r\n                `${status} ${studentName} updated: ${updated}, failed: ${failed}, marks: ${marks.join(\r\n                    ' '\r\n                )}, failureStatus: ${failureStatus}`\r\n            );\r\n        }\r\n        return status;\r\n    }\r\n\r\n    getSuitableControlAction(\r\n        config: ControlActionConfig,\r\n        controlActions: ControlAction[]\r\n    ) {\r\n        const suitableControlActions = controlActions.filter((a) =>\r\n            config.controlActions.some((b) =>\r\n                compareNormalized(a.controlAction, b)\r\n            )\r\n        );\r\n\r\n        if (suitableControlActions.length === 0) {\r\n            this.logger.log(\r\n                `All of ${config.controlActions.join(', ')} not found`\r\n            );\r\n            this.logger.log(\r\n                `Known actions: ${controlActions\r\n                    .map((a) => a.controlAction)\r\n                    .join(', ')}`\r\n            );\r\n            return null;\r\n        }\r\n\r\n        if (\r\n            config.matchIndex !== undefined ||\r\n            config.matchCount !== undefined\r\n        ) {\r\n            if (\r\n                config.matchIndex === undefined ||\r\n                config.matchCount === undefined ||\r\n                suitableControlActions.length !== config.matchCount ||\r\n                config.matchIndex >= config.matchCount\r\n            ) {\r\n                this.logger.log(\r\n                    `Invalid configuration of ${config.controlActions.join(\r\n                        ', '\r\n                    )}`\r\n                );\r\n                this.logger.log(\r\n                    `Can't match: ${config.matchIndex}/${config.matchCount} of ${suitableControlActions.length}`\r\n                );\r\n                return null;\r\n            }\r\n            return suitableControlActions[config.matchIndex];\r\n        }\r\n\r\n        if (suitableControlActions.length > 1) {\r\n            this.logger.log(\r\n                `Several control actions found for ${config.controlActions.join(\r\n                    ', '\r\n                )}`\r\n            );\r\n            this.logger.log(\r\n                `Found actions: ${suitableControlActions\r\n                    .map((a) => a.controlAction)\r\n                    .join(', ')}`\r\n            );\r\n            return null;\r\n        }\r\n\r\n        return suitableControlActions[0];\r\n    }\r\n\r\n    async updateFailuresForSkippedStudentsAsync(\r\n        students: StudentMark[],\r\n        discipline: Discipline,\r\n        defaultStudentFailure: StudentFailure\r\n    ) {\r\n        const statusCounters: { [k: string]: number } = {};\r\n\r\n        for (const student of students) {\r\n            const status = await this.updateFailureForStudent(\r\n                student,\r\n                discipline,\r\n                defaultStudentFailure\r\n            );\r\n            if (statusCounters[status] === undefined) {\r\n                statusCounters[status] = 0;\r\n            }\r\n            statusCounters[status]++;\r\n        }\r\n\r\n        const statusKeys = Object.keys(statusCounters);\r\n        if (statusKeys.length > 0) {\r\n            this.logger.log('Failures update statuses:');\r\n            for (const k of statusKeys) {\r\n                this.logger.log(`- ${k} = ${statusCounters[k]}`);\r\n            }\r\n        } else {\r\n            this.logger.log('No failures for skipped students');\r\n        }\r\n    }\r\n\r\n    async updateFailureForStudent(\r\n        student: StudentMark,\r\n        discipline: Discipline,\r\n        defaultStudentFailure: StudentFailure\r\n    ) {\r\n        let status = '';\r\n        const brsFailureStatus = student.failure\r\n            ? (student.failure as StudentFailure)\r\n            : StudentFailure.NoFailure;\r\n        const actualFailure = defaultStudentFailure;\r\n        if (actualFailure === brsFailureStatus) {\r\n            status = 'SKIPPED';\r\n        } else {\r\n            try {\r\n                if (this.options.save) {\r\n                    await this.brsApi.putStudentFailureAsync(\r\n                        student.studentUuid,\r\n                        discipline,\r\n                        actualFailure\r\n                    );\r\n                }\r\n                status = 'UPDATED';\r\n            } catch (error) {\r\n                status = 'FAILED';\r\n            }\r\n        }\r\n\r\n        if (this.options.verbose || status === 'FAILED') {\r\n            const studentName = (\r\n                student.studentFio + '                              '\r\n            ).substr(0, 30);\r\n            const description =\r\n                status !== 'SKIPPED'\r\n                    ? `${formatStudentFailure(\r\n                    actualFailure\r\n                    )} from ${formatStudentFailure(brsFailureStatus)}`\r\n                    : formatStudentFailure(actualFailure);\r\n            this.logger.log(`${status} ${studentName} ${description}`);\r\n        }\r\n        return status;\r\n    }\r\n\r\n    mergeStudents(actualStudents: ActualStudent[], brsStudents: StudentMark[]) {\r\n        const activeBrsStudents = brsStudents.filter(isStudentActive);\r\n\r\n        const mergedStudents: MergedStudent[] = [];\r\n        const skippedActualStudents: ActualStudent[] = [];\r\n        for (const actualStudent of actualStudents) {\r\n            const suitableStudents = activeBrsStudents.filter((brsStudent) =>\r\n                areStudentsLike(brsStudent, actualStudent)\r\n            );\r\n            if (suitableStudents.length === 1) {\r\n                mergedStudents.push({\r\n                    actual: actualStudent,\r\n                    brs: suitableStudents[0],\r\n                });\r\n            } else {\r\n                skippedActualStudents.push(actualStudent);\r\n            }\r\n        }\r\n\r\n        const skippedBrsStudents: StudentMark[] = [];\r\n        for (const brsStudent of activeBrsStudents) {\r\n            if (\r\n                !mergedStudents.some(\r\n                    (ms) => ms.brs.studentUuid === brsStudent.studentUuid\r\n                )\r\n            ) {\r\n                skippedBrsStudents.push(brsStudent);\r\n            }\r\n        }\r\n\r\n        return {mergedStudents, skippedActualStudents, skippedBrsStudents};\r\n    }\r\n\r\n    logMergedStudents(\r\n        mergedStudents: MergedStudent[],\r\n        skippedActualStudents: ActualStudent[],\r\n        skippedBrsStudents: StudentMark[]\r\n    ) {\r\n        this.logger.log(`Merged students = ${mergedStudents.length}`);\r\n        this.logger.log(\r\n            `Can't merge actual students = ${skippedActualStudents.length}`\r\n        );\r\n        for (const s of skippedActualStudents) {\r\n            this.logger.log('- ' + s.fullName);\r\n        }\r\n        this.logger.log(\r\n            `Can't merge BRS students = ${skippedBrsStudents.length}`\r\n        );\r\n        for (const s of skippedBrsStudents) {\r\n            this.logger.log('- ' + s.studentFio);\r\n        }\r\n    }\r\n}\r\n\r\nfunction isStudentActive(brsStudent: StudentMark) {\r\n    return (\r\n        brsStudent.studentStatus !== 'Переведен' &&\r\n        brsStudent.studentStatus !== 'Отчислен'\r\n    );\r\n}\r\n\r\nfunction areStudentsLike(\r\n    brsStudent: StudentMark,\r\n    actualStudent: ActualStudent\r\n) {\r\n    const brsFullName = fio.toKey(brsStudent.studentFio);\r\n    const actualFullName = fio.toKey(actualStudent.fullName);\r\n    return brsFullName.startsWith(actualFullName);\r\n}\r\n\r\nexport interface ControlActionConfig {\r\n    controlActions: string[];\r\n    matchIndex?: number;\r\n    matchCount?: number;\r\n    propertyIndex: number;\r\n}\r\n\r\nexport interface PutMarksOptions {\r\n    save: boolean;\r\n    verbose: boolean;\r\n}\r\n\r\ninterface MergedStudent {\r\n    actual: ActualStudent;\r\n    brs: StudentMark;\r\n}\r\n","export class Logger {\r\n    private logHandlers?: ((message: string) => void)[];\r\n    private errorHandlers?: ((errorMessage: string) => void)[];\r\n\r\n    addLogHandler(logHandler: ((message: string) => void)) {\r\n        if (!this.logHandlers)\r\n            this.logHandlers = [];\r\n        this.logHandlers.push(logHandler);\r\n    }\r\n\r\n    removeLogHandler(logHandler: ((message: string) => void)) {\r\n        if (!this.logHandlers)\r\n            return;\r\n        this.logHandlers = this.logHandlers.filter(h => h !== logHandler);\r\n    }\r\n\r\n    addErrorHandler(errorHandler: (errorMessage: string) => void) {\r\n        if (!this.errorHandlers)\r\n            this.errorHandlers = [];\r\n        this.errorHandlers.push(errorHandler);\r\n    }\r\n\r\n    removeErrorHandler(errorHandler: ((errorMessage: string) => void)) {\r\n        if (!this.errorHandlers)\r\n            return;\r\n        this.errorHandlers = this.errorHandlers.filter(h => h !== errorHandler);\r\n    }\r\n\r\n    log(message: string) {\r\n        if (!this.logHandlers)\r\n            return;\r\n        for (const logHandler of this.logHandlers)\r\n            logHandler(message);\r\n    }\r\n\r\n    error(errorMessage: string) {\r\n        if (!this.errorHandlers)\r\n            return;\r\n        for (const errorHandler of this.errorHandlers)\r\n            errorHandler(errorMessage);\r\n    }\r\n}\r\n","import React from 'react';\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport {Dialog, List, ListItem, ListItemText} from \"@material-ui/core\";\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\r\nimport MuiDialogContent from '@material-ui/core/DialogContent';\r\nimport MuiDialogActions from '@material-ui/core/DialogActions';\r\nimport SubmitWithLoading from \"../../../submitWithLoading\";\r\nimport MarksManager from \"../../../../marksActions/MarksManager\";\r\nimport {Discipline} from \"../../../../apis/brsApi\";\r\nimport {SpreadsheetData} from \"../../../../functions/getSpreadsheetDataAsync\";\r\nimport \"./styles.css\"\r\n\r\nconst DialogContent = withStyles(() => ({\r\n    root: {\r\n        padding: 0,\r\n    },\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles(() => ({\r\n    root: {\r\n        display: 'flex',\r\n        justifyContent: 'space-around'\r\n    },\r\n}))(MuiDialogActions);\r\n\r\nexport default class WorkerDialog extends React.Component<Props, State> {\r\n    marksManager: MarksManager;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.marksManager = props.marksManager;\r\n\r\n        this.state = {\r\n            okLoading: true,\r\n            cancelPending: false,\r\n            logItems: [],\r\n        };\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.startWork();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.cancelWork();\r\n    }\r\n\r\n    logMessage = (message: string) => {\r\n        this.setState({logItems: [...this.state.logItems, message]});\r\n    }\r\n\r\n    startWork = async () => {\r\n        this.marksManager.getLogger().addLogHandler(this.logMessage);\r\n\r\n        const {spreadsheetData, suitableDisciplines} = this.props.marksData;\r\n        await this.marksManager.putMarksToBrsAsync(spreadsheetData, suitableDisciplines);\r\n\r\n        this.marksManager.getLogger().removeLogHandler(this.logMessage);\r\n\r\n        this.setState({\r\n            cancelPending: false,\r\n            okLoading: false\r\n        });\r\n    }\r\n\r\n    cancelWork = () => {\r\n        this.setState({cancelPending: true});\r\n        this.marksManager.cancel();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <React.Fragment>\r\n                <Dialog open={this.props.runWork} maxWidth=\"md\" fullWidth className=\"worker-dialog\">\r\n                    <MuiDialogTitle>Лог действий</MuiDialogTitle>\r\n                    <DialogContent dividers>\r\n                        <List dense disablePadding style={{minHeight: 400}}>\r\n                            {this.state.logItems.map((item, index) => (\r\n                                <ListItem key={index} style={{paddingTop: 0, paddingBottom: 0}}>\r\n                                    <ListItemText primary={item} style={{marginTop: 2, marginBottom: 2}}/>\r\n                                </ListItem>\r\n                            ))}\r\n                        </List>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <SubmitWithLoading loading={this.state.okLoading}\r\n                                           onClick={this.props.onClosed}\r\n                                           title=\"ок\"/>\r\n                        <SubmitWithLoading loading={this.state.cancelPending}\r\n                                           disabled={!this.state.okLoading}\r\n                                           onClick={this.cancelWork}\r\n                                           title=\"отмена\"/>\r\n                    </DialogActions>\r\n                </Dialog>\r\n            </React.Fragment>\r\n        );\r\n    }\r\n}\r\n\r\nexport interface MarksData {\r\n    spreadsheetData: SpreadsheetData;\r\n    suitableDisciplines: Discipline[];\r\n}\r\n\r\ninterface Props {\r\n    runWork: boolean;\r\n    marksManager: MarksManager;\r\n    marksData: MarksData;\r\n    onClosed: () => void;\r\n}\r\n\r\ninterface State {\r\n    okLoading: boolean;\r\n    cancelPending: boolean;\r\n    logItems: string[];\r\n}\r\n","import React, {FormEvent, memo} from \"react\";\r\nimport getSpreadsheetDataAsync, {DisciplineConfig, SpreadsheetData} from \"../../functions/getSpreadsheetDataAsync\";\r\nimport NestedList, {INestedItem, INestedListItem} from \"../nestedList\";\r\nimport {Collapse, TextField} from \"@material-ui/core\";\r\nimport SubmitWithLoading from \"../submitWithLoading\";\r\nimport {getSpreadsheetProperties} from \"../../apis/googleApi\";\r\nimport getSuitableDisciplinesAsync from \"../../functions/getSuitableDisciplinesAsync\";\r\nimport BrsApi, {Discipline} from \"../../apis/brsApi\";\r\nimport * as cache from \"../../helpers/cache\"\r\nimport {StorageType} from \"../../helpers/cache\"\r\nimport './styles.css';\r\nimport catchOrReturn from \"../../helpers/catchOrReturn\";\r\nimport RunWorkerButtons from \"../workPage/worker/RunWorkerButtons\";\r\nimport MarksManager, {PutMarksOptions} from \"../../marksActions/MarksManager\";\r\nimport {Logger} from \"../../helpers/logger\";\r\nimport WorkerDialog, {MarksData} from \"../workPage/worker/workerDialog\";\r\n\r\nclass SpreadsheetFetch extends React.Component<Props, State> {\r\n    marksData: MarksData = {} as any;\r\n    marksManager: MarksManager = {} as any;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            tableUrl: '',\r\n            loading: false,\r\n            showDisciplines: false,\r\n            tableUrlError: {error: false, message: ''},\r\n            disciplines: [],\r\n            disciplinesMissed: false,\r\n            showWorkerButtons: false,\r\n            runWorker: false\r\n        };\r\n\r\n    }\r\n\r\n    handleTableUrlChanged = (event: React.ChangeEvent<{ name?: string | undefined, value: unknown }>) => {\r\n        const target = event.target;\r\n        switch (target.name) {\r\n            case 'table-url':\r\n                if (this.state.tableUrlError.error)\r\n                    this.setState({tableUrlError: {error: false, message: ''}});\r\n                this.setState({tableUrl: target.value as string});\r\n        }\r\n    }\r\n\r\n    loadDisciplines = async (e?: FormEvent) => {\r\n        e?.preventDefault();\r\n        this.setState({loading: true});\r\n\r\n        const spreadsheetData = await this.getActualSpreadsheetDataAsync();\r\n        if (!spreadsheetData)\r\n            return;\r\n\r\n        const availableDisciplines = await this.getAvailableDisciplinesAsync(spreadsheetData.disciplineConfig);\r\n        if (!availableDisciplines)\r\n            return;\r\n\r\n        const disciplinesInfo = this.disciplinesToListItems(availableDisciplines, spreadsheetData);\r\n\r\n        this.marksData.spreadsheetData = spreadsheetData;\r\n        this.marksData.suitableDisciplines = availableDisciplines;\r\n\r\n        this.setState({\r\n            loading: false,\r\n            disciplines: disciplinesInfo.disciplines,\r\n            showDisciplines: true,\r\n            disciplinesMissed: disciplinesInfo.missed,\r\n            showWorkerButtons: !disciplinesInfo.missed\r\n        });\r\n    }\r\n\r\n    disciplinesToListItems(availableDisciplines: Discipline[], spreadsheetData: SpreadsheetData)\r\n        : { missed: boolean, disciplines: INestedListItem[] } {\r\n\r\n        const actualGroups = new Set(spreadsheetData.actualStudents.map(s => s.groupName));\r\n        const availableGroups = new Set(availableDisciplines.map(s => s.group));\r\n\r\n        let missedCount = 0;\r\n        const nestedItems: INestedItem[] = Array.from(actualGroups)\r\n            .map(group => {\r\n                const groupMissed = !availableGroups.has(group);\r\n                if (groupMissed)\r\n                    missedCount++;\r\n                return {title: group, colored: groupMissed};\r\n            });\r\n\r\n        return {\r\n            missed: missedCount == actualGroups.size,\r\n            disciplines: [{\r\n                title: spreadsheetData.disciplineConfig.name,\r\n                nestedItems\r\n            }]\r\n        };\r\n    }\r\n\r\n    async getAvailableDisciplinesAsync(disciplineConfig: DisciplineConfig) {\r\n        return getSuitableDisciplinesAsync(this.props.brsApi, disciplineConfig)\r\n            .then(x => x, error => {\r\n                this.setState({loading: false})\r\n                this.props.onError(error)\r\n            });\r\n    }\r\n\r\n    async getActualSpreadsheetDataAsync() {\r\n        const spreadsheetInfo = await this.getSpreadsheetInfoAsync();\r\n        if (!spreadsheetInfo) {\r\n            this.setState({loading: false});\r\n            return null;\r\n        }\r\n\r\n        let spreadsheetData: SpreadsheetData;\r\n        try {\r\n            spreadsheetData = await getSpreadsheetDataAsync(spreadsheetInfo.spreadsheetId, spreadsheetInfo.sheetName);\r\n        } catch (e) {\r\n            this.setState({loading: false})\r\n            this.props.onError(e.message || JSON.stringify(e));\r\n            return null;\r\n        }\r\n\r\n        return spreadsheetData;\r\n    }\r\n\r\n    async getSpreadsheetInfoAsync(): Promise<{ spreadsheetId: string, sheetName: string } | null> {\r\n        const regExp = /d\\/(?<spreadsheetId>[a-zA-Z0-9-_]+)\\/edit(#gid=(?<sheetId>[0-9]+))?/;\r\n        const result = this.state.tableUrl.match(regExp);\r\n\r\n        if (!result?.groups || !result.groups.spreadsheetId) {\r\n            this.setState({\r\n                loading: false,\r\n                tableUrlError: {error: true, message: 'Неверный url-адрес.'}\r\n            });\r\n            return null;\r\n        }\r\n        const spreadsheetId = result.groups.spreadsheetId;\r\n        const maybeSheetId = result.groups.sheetId || null;\r\n\r\n        try {\r\n            const spreadsheetProperties = await getSpreadsheetProperties(spreadsheetId);\r\n            const maybeSheet = maybeSheetId\r\n                ? spreadsheetProperties.filter(s => s.sheetId.toString() === maybeSheetId)[0]\r\n                : spreadsheetProperties[0];\r\n            if (!maybeSheet) {\r\n                this.props.onError('Sheet is not found');\r\n                return null;\r\n            }\r\n            const sheetName = maybeSheet.title;\r\n            return {spreadsheetId, sheetName};\r\n        } catch (e) {\r\n            this.props.onError(e.message || JSON.stringify(e));\r\n            return null;\r\n        }\r\n    }\r\n\r\n    updateCachedDisciplines = (event: React.MouseEvent<HTMLAnchorElement, MouseEvent>) => {\r\n        event.preventDefault();\r\n        this.setState({showWorkerButtons: false})\r\n\r\n        const login = catchOrReturn(() => this.props.brsApi.brsAuth.login, this.props.onError);\r\n        if (!login)\r\n            return;\r\n\r\n        const disciplineConfig = this.marksData.spreadsheetData?.disciplineConfig;\r\n        if (!disciplineConfig)\r\n            return;\r\n\r\n        const cacheName = cache.buildCacheName(login, \"getDiscipline\", disciplineConfig);\r\n        cache.clear(cacheName, StorageType.Local);\r\n\r\n        this.loadDisciplines();\r\n    }\r\n\r\n    runWork = (save: boolean) => {\r\n        const logger = new Logger();\r\n        logger.addErrorHandler(this.props.onError);\r\n\r\n        const options: PutMarksOptions = {save, verbose: true};\r\n\r\n        this.marksManager = new MarksManager(this.props.brsApi, logger, options);\r\n\r\n        this.setState({runWorker: true});\r\n    }\r\n\r\n    handleRunWorkSafe = () => this.runWork(false)\r\n\r\n    handleRunWorkUnsafe = () => this.runWork(true)\r\n\r\n    handleWorkerClosed = () => this.setState({runWorker: false})\r\n\r\n    render() {\r\n        return (\r\n            <span className={'spreadsheet-fetch'}>\r\n                <h3 className={'vertical-margin-min'}>Вставьте ссылку на лист Google Таблицы с оценками</h3>\r\n                <form onSubmit={this.loadDisciplines} className={'vertical-margin-min'}>\r\n                    <TextField name=\"table-url\"\r\n                               label=\"Ссылка\"\r\n                               type=\"text\"\r\n                               className={'tableUrl'}\r\n                               value={this.state.tableUrl}\r\n                               onChange={this.handleTableUrlChanged}\r\n                               error={this.state.tableUrlError.error}\r\n                               helperText={this.state.tableUrlError.message}\r\n                               required/>\r\n                    <SubmitWithLoading title=\"загрузить\"\r\n                                       loading={this.state.loading}\r\n                                       className={'submit'}/>\r\n                </form>\r\n                <Collapse in={this.state.showDisciplines} className={\"vertical-margin-min\"}>\r\n                    <h3>Загруженная дисциплина из Google Таблицы</h3>\r\n                    <p>Группы, к которым у Вас нет доступа в БРС, <b className={\"colored-text\"}> подсвечены</b></p>\r\n                    <NestedList items={this.state.disciplines} collapsed={false}/>\r\n                    {this.state.disciplinesMissed ?\r\n                        <React.Fragment>\r\n                            <span>У Вас нет доступа ни к одной из перечисленных групп в БРС</span>\r\n                            <ol className={\"no-margin\"}>\r\n                                <li>Убедитесь, что название курса в БРС и в Google Таблицах совпадает</li>\r\n                                <li>Запросите доступ на курс в БРС</li>\r\n                                <li><a className={\"button-link\"}\r\n                                       onClick={this.updateCachedDisciplines}>Обновите кэш групп</a></li>\r\n                            </ol>\r\n                        </React.Fragment> :\r\n                        <React.Fragment>\r\n                            <p>Если Вам доступны не все группы, которые вам доступны в БРС, то <a\r\n                                className={\"button-link\"}\r\n                                aria-disabled={true}\r\n                                onClick={this.updateCachedDisciplines}>обновите кэш групп</a>\r\n                            </p>\r\n                            <RunWorkerButtons enabled={this.state.showWorkerButtons}\r\n                                              onRunWorkSafe={this.handleRunWorkSafe}\r\n                                              onRunWorkUnsafe={this.handleRunWorkUnsafe}/>\r\n                        </React.Fragment>\r\n                    }\r\n                </Collapse>\r\n                {this.state.runWorker &&\r\n                <WorkerDialog marksData={this.marksData}\r\n                              onClosed={this.handleWorkerClosed}\r\n                              runWork={this.state.runWorker}\r\n                              marksManager={this.marksManager}/>\r\n                }\r\n            </span>\r\n        );\r\n    }\r\n}\r\n\r\nexport default memo(SpreadsheetFetch);\r\n\r\ninterface Props {\r\n    brsApi: BrsApi;\r\n    onError: (errorMessage: string) => void;\r\n}\r\n\r\ninterface State {\r\n    tableUrl: string;\r\n    loading: boolean;\r\n    showDisciplines: boolean;\r\n    tableUrlError: { error: boolean, message: string };\r\n    disciplines: INestedListItem[];\r\n    disciplinesMissed: boolean;\r\n    showWorkerButtons: boolean;\r\n    runWorker: boolean;\r\n}\r\n","export default function catchOrReturn<T>(action: () => T, onError: (error: any) => void): T | null {\r\n    try {\r\n        return action();\r\n    } catch (e) {\r\n        onError(e);\r\n        return null;\r\n    }\r\n}\r\n","import React from 'react';\r\nimport {Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, Slide} from '@material-ui/core';\r\nimport {TransitionProps} from '@material-ui/core/transitions';\r\nimport {Redirect} from 'react-router-dom';\r\nimport BrsAuth from \"../apis/brsAuth\";\r\n\r\nconst Transition = React.forwardRef(function Transition(\r\n    props: TransitionProps & { children?: React.ReactElement<any, any> },\r\n    ref: React.Ref<unknown>,\r\n) {\r\n    return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nexport default function SessionExpiredAlert({open, sessionName, brsAuth}: Props) {\r\n    const [redirect, setRedirect] = React.useState(false);\r\n\r\n    const handleOk = () => {\r\n        setRedirect(true);\r\n    };\r\n\r\n    return (\r\n        <React.Fragment>\r\n            {redirect && <Redirect to=\"/\"/>}\r\n            <Dialog\r\n                open={open}\r\n                TransitionComponent={Transition}\r\n                keepMounted\r\n                aria-labelledby=\"alert-dialog-slide-title\"\r\n                aria-describedby=\"alert-dialog-slide-description\">\r\n                <DialogTitle id=\"alert-dialog-slide-title\">Необходимо авторизоваться</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText id=\"alert-dialog-slide-description\">\r\n                        Кажется, действие сессии {sessionName} истекло. Необходимо повторно авторизоваться.\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions style={{display: 'flex', justifyContent: 'space-around'}}>\r\n                    <Button onClick={handleOk} color=\"primary\">Ок</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\ninterface Props {\r\n    open: boolean;\r\n    sessionName: string;\r\n    brsAuth: BrsAuth;\r\n}\r\n","import React from \"react\";\r\nimport \"./styles.css\";\r\nimport {CircularProgress} from \"@material-ui/core\";\r\n\r\nexport default function () {\r\n    return (\r\n        <div className={\"loading-pane\"}>\r\n            <CircularProgress size={100} className={\"progress\"}/>\r\n        </div>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport {Button, Container,} from \"@material-ui/core\";\r\nimport SpreadsheetFetch from \"../spreadsheetFetch\";\r\nimport BrsApi from \"../../apis/brsApi\";\r\nimport SessionExpiredAlert from \"../SessionExpiredAlert\";\r\nimport CustomAlert from \"../CustomAlert\";\r\nimport googleAuth from \"../../apis/googleAuth\";\r\nimport BrsAuth from \"../../apis/brsAuth\";\r\nimport {StatusCode} from \"../../helpers/CustomError\";\r\nimport LoadingPane from \"./loadingPane/LoadingPane\";\r\nimport {Redirect} from \"react-router-dom\";\r\n\r\nexport default class WorkPage extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            showControls: false,\r\n            runWork: false,\r\n            openSessionExpiredAlert: false,\r\n            sessionName: '',\r\n            errorMessage: '',\r\n            loading: true,\r\n            redirect: false\r\n        }\r\n\r\n    }\r\n\r\n    async componentDidMount() {\r\n        await googleAuth.init();\r\n        await this.props.brsAuth.tryRestoreAsync();\r\n\r\n        const brsAuthorized = this.props.brsAuth.checkAuth();\r\n        const googleAuthorized = googleAuth.checkAuthorized();\r\n\r\n        if (!brsAuthorized)\r\n            this.handleSessionExpired(\"БРС\");\r\n        else if (!googleAuthorized)\r\n            this.handleSessionExpired(\"Google\");\r\n        else\r\n            this.setState({loading: false});\r\n    }\r\n\r\n    handleSessionExpired = (sessionName: string) => {\r\n        this.setState({openSessionExpiredAlert: true, sessionName, loading: false});\r\n    }\r\n\r\n    handleError = (error: any) => {\r\n        const errorMessage: string = error.message || JSON.stringify(error);\r\n        if (error.statusCode)\r\n            if (error.statusCode === StatusCode.BrsUnauthorized)\r\n                this.handleSessionExpired(\"БРС\");\r\n            else\r\n                this.handleSessionExpired(\"Google\");\r\n        else if (error.name === \"RequestError\")\r\n            this.setState({errorMessage: \"В данный момент сервер недоступен. Попробуйте позже.\"});\r\n        else\r\n            this.setState({errorMessage});\r\n    }\r\n\r\n    closeError = () => {\r\n        this.setState({errorMessage: ''})\r\n    }\r\n\r\n    returnToLoginPage = () => {\r\n        this.setState({redirect: true})\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <React.Fragment>\r\n                {this.state.loading && <LoadingPane/>}\r\n                {this.state.openSessionExpiredAlert && <SessionExpiredAlert brsAuth={this.props.brsAuth}\r\n                                                                            sessionName={this.state.sessionName}\r\n                                                                            open={this.state.openSessionExpiredAlert}/>}\r\n                {this.state.errorMessage && <CustomAlert open={!!this.state.errorMessage}\r\n                                                         message={this.state.errorMessage}\r\n                                                         type={'error'}\r\n                                                         onClose={this.closeError}/>}\r\n                {this.state.redirect && <Redirect to=\"/\"/>}\r\n                <div className=\"work-page\">\r\n                    <Container maxWidth=\"md\">\r\n                        <Button variant=\"contained\"\r\n                                style={{marginTop: 10}}\r\n                                onClick={this.returnToLoginPage}>\r\n                            Вернуться на страницу входа\r\n                        </Button>\r\n                        <SpreadsheetFetch brsApi={this.props.brsApi} onError={this.handleError}/>\r\n                    </Container>\r\n                </div>\r\n            </React.Fragment>\r\n        );\r\n    }\r\n}\r\n\r\ninterface State {\r\n    showControls: boolean;\r\n    openSessionExpiredAlert: boolean;\r\n    sessionName: string;\r\n    errorMessage: string;\r\n    runWork: boolean;\r\n    loading: boolean;\r\n    redirect: boolean;\r\n}\r\n\r\ninterface Props {\r\n    brsAuth: BrsAuth;\r\n    brsApi: BrsApi;\r\n}\r\n","import React from \"react\";\r\nimport Context from \"../../Context\";\r\nimport WorkPage from \"./WorkPage\";\r\n\r\nexport default function () {\r\n    return (\r\n        <Context.Consumer>\r\n            {\r\n                context => <WorkPage brsAuth={context.brsAuth} brsApi={context.brsApi}/>\r\n            }\r\n        </Context.Consumer>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport {HashRouter, Route, Switch} from 'react-router-dom';\r\nimport BrsUrlProvider from \"./apis/brsUrlProvider\";\r\nimport BrsAuth from \"./apis/brsAuth\";\r\nimport LoginPageWrapper from \"./components/loginPage/LoginPageWrapper\";\r\nimport WorkPageWrapper from \"./components/workPage/WorkPageWrapper\";\r\nimport BrsApi from \"./apis/brsApi\";\r\nimport Context from './Context';\r\n\r\nconst urlProvider = new BrsUrlProvider(true);\r\nconst brsAuth = new BrsAuth(urlProvider);\r\nconst brsApi = new BrsApi(brsAuth, urlProvider);\r\n\r\nexport default function App() {\r\n    return (\r\n        <Context.Provider value={{brsAuth, brsApi}}>\r\n            <HashRouter hashType={\"noslash\"}>\r\n                <Switch>\r\n                    <Route path=\"/work\" component={WorkPageWrapper}/>\r\n                    <Route exact path=\"\" component={LoginPageWrapper}/>\r\n                </Switch>\r\n            </HashRouter>\r\n        </Context.Provider>\r\n    )\r\n}\r\n","import {ReportHandler} from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n    if (onPerfEntry && onPerfEntry instanceof Function) {\r\n        import('web-vitals').then(({getCLS, getFID, getFCP, getLCP, getTTFB}) => {\r\n            getCLS(onPerfEntry);\r\n            getFID(onPerfEntry);\r\n            getFCP(onPerfEntry);\r\n            getLCP(onPerfEntry);\r\n            getTTFB(onPerfEntry);\r\n        });\r\n    }\r\n}\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nimport './index.css';\r\n\r\nReactDOM.render(\r\n    <App/>,\r\n    document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}